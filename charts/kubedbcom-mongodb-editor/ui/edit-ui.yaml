type: multi-step-form
step:
  - type: single-step-form
    id: backupconfiguration
    # label: Backup
    schema: schema/
    elements:
      - type: radio
        label: Schedule a Backup?
        schema: temp/properties/scheduleBackup
        isHorizontal: true
        options:
          - text: 'Yes'
            value: 'yes'
          - text: 'No'
            value: 'no'
        if:
          type: function
          name: showScheduleBackup
        init:
          type: func
          value: initScheduleBackupForEdit
        watcher:
          func: onScheduleBackupChange
          paths:
            - temp/properties/scheduleBackup
      - type: block-layout
        label: Backup Form
        showLabels: false
        loader: initBackupData
        if:
          type: function
          name: showBackupForm
        elements:
          - type: radio
            label: Select Backup Type
            schema: temp/properties/backupType
            isHorizontal: true
            options:
              - text: BackupConfig
                value: BackupConfig
                description: 'Create, Delete or Modify BackupConfig'
              - text: BackupBlueprint
                value: BackupBlueprint
                description: Enable/Disable BackupBlueprint
            if:
              type: function
              name: isBackupDataLoadedTrue
            init:
              type: func
              value: setBackupType
            loader: getTypes
            watcher:
              func: onBackupTypeChange
              paths:
                - temp/properties/backupType
          - type: block-layout
            label: Config
            if:
              type: function
              name: isBackupType|BackupConfig
            elements:
              - type: select
                label: Select Context
                schema: temp/properties/backupConfigContext
                validation:
                  type: required
                loader: getContext
                watcher:
                  func: onContextChange
                  paths:
                    - temp/properties/backupConfigContext
              - type: select
                label: Select BackupConfig
                schema: temp/properties/config
                validation:
                  type: required
                if:
                  type: function
                  name: showConfigList
                loader: getConfigList
                watcher:
                  func: onConfigChange
                  paths:
                    - temp/properties/config
              - type: input
                label: Schedule
                schema: temp/properties/schedule
                validation:
                  type: required
                if:
                  type: function
                  name: showSchedule
                loader:
                  name: getDefaultSchedule|/resources/coreKubestashComBackupConfiguration/spec/sessions
                  watchPaths:
                    - temp/properties/config
                watcher:
                  func: onInputChangeSchedule|/resources/coreKubestashComBackupConfiguration/spec/sessions|schedule
                  paths:
                    - temp/properties/schedule
              - type: switch
                label: Paused
                schema: schema/properties/resources/properties/coreKubestashComBackupConfiguration/properties/spec/properties/paused
                if:
                  type: function
                  name: showPause
          - type: block-layout
            label: Blueprint
            if:
              type: function
              name: isBackupType|BackupBlueprint
            elements:
              - type: switch
                label: Enable Backup Blueprint
                schema: temp/properties/blueprintEnabled
                init:
                  type: func
                  value: setBlueprintSwitch
                watcher:
                  func: onBlueprintChange
                  paths:
                    - temp/properties/blueprintEnabled
          - type: block-layout
            label: Archiver
            if:
              type: function
              name: isBackupType|Archiver
            elements:
              - type: switch
                label: Enable Archiver
                schema: temp/properties/archiverEnabled
                init:
                  type: func
                  value: setArchiverSwitch
                watcher:
                  func: onArchiverChange
                  paths:
                    - temp/properties/archiverEnabled

  - type: single-step-form
    id: monitoring
    elements:
    - type: label-element
      label: To update Exporter Resource section click on Create OpsRequest
    - type: anchor
      label: Create OpsRequest
      schema: temp/properties/opsRequestUrl
      init:
        type: func
        value: getOpsRequestUrl|VerticalScaling
    - type: switch
      label: Enable Monitoring
      schema: temp/properties/enableMonitoring
      init: 
        type: func
        value: isValueExistInModel|/resources/kubedbComMongoDB/spec/monitor
      watcher:
        func: onEnableMonitoringChange
        paths:
          - temp/properties/enableMonitoring
    - type: block-layout
      label: Backup form 
      showLabels: false
      if:
        type: function
        name: showMonitoringSection
      elements:
        - type: radio
          label: Select a Monitoring Method
          schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/agent
          isHorizontal: true
          options:
          - text: Prometheus Operator
            value: prometheus.io/operator
            description: Inject metric exporter sidecar and creates a ServiceMonitor
          - text: Custom ServiceMonitor
            value: prometheus.io
            description: Injects the metric exporter sidecar and let you customize ServiceMonitor
          - text: Custom Scrapper
            value: prometheus.io/builtin
            description: Inject metric exporter sidecar and add Prometheus annotations to the stats Service
          init:
            type: static
            value: prometheus.io/operator
          watcher:
            func: onAgentChange
            paths:
              - schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/agent
        - type: block-layout
          label: ServiceMonitor Configuration  
          showLabels: true 
          if: 
            type: function
            name: isEqualToModelPathValue|prometheus.io/operator|/resources/kubedbComMongoDB/spec/monitor/agent
          elements:
            - label: Scrapping Interval
              schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/serviceMonitor/properties/interval
              type: input 
        - type: block-layout
          label: Service Monitor
          showLabels: true
          if:
            type: function
            name: isEqualToModelPathValue|prometheus.io|/resources/kubedbComMongoDB/spec/monitor/agent
          elements:
          - type: array-object-form
            label: Endpoints
            schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/endpoints
            elements:
            - type: switch
              label: Honor labels
              schema: honorLabels
            - type: input
              label: Interval
              schema: interval
            - type: input
              label: Path
              schema: path
            - type: input
              label: Port
              schema: port
          - type: select
            multiple: true
            label: Match Namespaces
            schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/namespaceSelector/properties/matchNames
            loader: getResources|core|v1|namespaces
            if: 
              type: function
              name: returnFalse
          - type: block-layout
            showLabels: false
            # schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/selector
            if: 
              type: function
              name: returnFalse
            elements:
              - type: object-item
                label: Labels
                schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/selector/properties/matchLabels
        - type: object-item
          schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/metadata/properties/labels
          label : Labels
          if:
            type: function
            name: isEqualToModelPathValue|prometheus.io|/resources/kubedbComMongoDB/spec/monitor/agent
          # individualItemDisabilityCheck: disableLableChecker
        - type: label-element
          label: Exporter Configuration
          schema: ''
        - type: switch
          label: Customize Exporter Sidecar
          schema: temp/properties/customizeExporter
          init: 
            type: static
            value: true
          watcher:
            func: onCustomizeExporterChange
            paths: 
              - temp/properties/customizeExporter
        - type: block-layout
          label: Customer Exporter Section 
          showLabels: false
          loader: setMetadata
          if:
            type: function
            name: showCustomizeExporterSection
          elements:
            - type: machine-compare
              label: Resources
              schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/resources
              if: 
                type: function
                name: returnFalse
            - type: label-element
              label: Security Context
              schema: ''
            - type: input
              schema:  schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/securityContext/properties/runAsUser
              label: Run as User
            - type: input
              schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/securityContext/properties/runAsGroup
              label: Run as Group
            - type: input
              schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/port
              label: Port
            - type: array-item-form
              label: Args
              schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/args
              init: 
                type: static
                value: ['--compatible-mode']
              element:
                type: input
                label: Args
                schema: items
                # isSubsection: true
            - type: block-layout
              label: Metadata
              showLabels: false
              elements: 
                  #remove: should be array-object-form after fixes
                - type: block-layout
                  label: New Environment Variable
                  showLabels: true
                  hideBlock: true
                  # schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env
                  elements:
                  - type: input
                    label: Name
                    schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/name
                  - type: radio
                    label: Value From
                    schema: temp/properties/valueFromType
                    init: 
                      type: func 
                      value: setValueFrom
                    options:
                    - text: Input
                      value: input
                    - text: Secret
                      value: secret
                    - text: ConfigMap
                      value: configMap
                    watcher:
                      func: onValueFromChange
                      paths:
                        - temp/properties/valueFromType
                  - type: input 
                    label: Value 
                    schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/value
                    if:
                      name: isEqualToValueFromType|input
                      type: function
                  - type: select
                    if:
                      type: function
                      name: isEqualToValueFromType|configMap
                    label: ConfigMap Name
                    schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/configMapKeyRef/properties/name
                    loader:
                      name: resourceNames|core|v1|configmaps
                      watchPaths:
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true
                  - type: select
                    label: ConfigMap Key
                    schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/configMapKeyRef/properties/key
                    if:
                      type: function
                      name: isEqualToValueFromType|configMap
                    loader:
                      name: getConfigMapKeys
                      watchPaths:
                        - schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/valueFrom/configMapKeyRef/name
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true
                  - type: select
                    label: Secret Name
                    schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/secretKeyRef/properties/name
                    if:
                      type: function
                      name: isEqualToValueFromType|secret
                    loader:
                      name: getSecrets
                      watchPaths:
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true
                  - type: select
                    label: Secret Key
                    schema: schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/secretKeyRef/properties/key
                    if:
                      type: function
                      name: isEqualToValueFromType|secret
                    loader:
                      name: getSecretKeys
                      watchPaths:
                        - schema/properties/resources/properties/kubedbComMongoDB/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/valueFrom/secretKeyRef/name
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true

  - type: single-step-form
    id: compute-autoscaler
    loader: getDbDetails
    elements:
    - type: block-layout
      showLabels: false
      loader: fetchTopologyMachines
      elements:
        # standalone mode
        - type: block-layout
          label: Standalone
          if:
            type: function
            name: mongoTypeEqualsTo|standalone|compute
          showLabels: true
          # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone
          elements:
            - type: select
              label: Trigger
              init:
                type: func
                value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/standalone/trigger
              options: 
                - text: 'On'
                  value: 'On'
                - text: 'Off'
                  value: 'Off'
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/trigger
            - type: input
              label: Pod LifeTime Threshold 
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/podLifeTimeThreshold
            - type: threshold-input
              label: Resource Diff Percentage
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/resourceDiffPercentage
            - type: label-element
              label: Resource Limits
              subtitle: Set minimum and maximum CPU and memory limits for your database pods to ensure optimal resource allocation and prevent over or under provisioning
            - type: block-layout
              showLabels: false
              elements:
                - type: horizontal-layout
                  elements:
                  - type: machine-compare
                    label: Min Allowed Profile
                    schema: temp/properties/allowedMachine-standalone-min
                    if:
                      type: function
                      name: hasAnnotations
                    init:
                      type: func
                      value: setAllowedMachine|standalone|min
                    loader:
                      name: getMachines|standalone|min
                      watchPaths:
                        - temp/properties/topologyMachines
                        - temp/properties/allowedMachine-standalone-max
                    watcher:
                      func: onMachineChange|standalone
                      paths:
                        - temp/properties/allowedMachine-standalone-min
                  - type: block-layout
                    label: Min Allowed
                    if:
                      type: function
                      name: hasNoAnnotations
                    showLabels: true
                    elements:
                      - type: input-compare
                        label: Cpu
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/minAllowed/properties/cpu
                      - type: input-compare
                        label: Memory
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/minAllowed/properties/memory
                  - type: machine-compare
                    label: Max Allowed Profile
                    schema: temp/properties/allowedMachine-standalone-max
                    if:
                      type: function
                      name: hasAnnotations
                    init:
                      type: func
                      value: setAllowedMachine|standalone|max
                    loader:
                      name: getMachines|standalone|max
                      watchPaths:
                        - temp/properties/topologyMachines
                        - temp/properties/allowedMachine-standalone-min
                    watcher:
                      func: onMachineChange|standalone
                      paths:
                        - temp/properties/allowedMachine-standalone-max
                  - type: block-layout
                    label: Max Allowed
                    if:
                      type: function
                      name: hasNoAnnotations
                    showLabels: true
                    elements:
                      - type: input-compare
                        label: Cpu
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/maxAllowed/properties/cpu
                      - type: input-compare
                        label: Memory
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/maxAllowed/properties/memory
            - type: select
              label: Controlled Resources
              loader: setControlledResources|compute/standalone
              multiple: true
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/controlledResources
            - type: select
              label: Container Controlled Values
              options:
              - text: Requests And Limits
                value: RequestsAndLimits
              - text: Requests Only
                value: RequestsOnly
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/containerControlledValues
            - type: block-layout
              label: In Memory Storage
              showLabels: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/inMemoryStorage
              elements:
                - type: threshold-input
                  label: Scaling Factor Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/inMemoryStorage/properties/scalingFactorPercentage
                - type: threshold-input
                  label: Usage Threshold Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/standalone/properties/inMemoryStorage/properties/usageThresholdPercentage
        #  replicaset mode
        - type: switch
          label: Trigger
          fullwidth: true
          init:
              type: func
              value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/replicaSet/trigger
          schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/trigger
        - type: label-element
          label: Pod lifetime threshold 
          subtitle: Specifies the duration a pod can exist before using considered for scaling decisions, ensuring resource optimization and workload stability  
        - type: input
          label: Pod LifeTime Threshold (e.g., 10m 30s)
          schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/podLifeTimeThreshold
          customClass: width-300  
        - type: block-layout
          label: ReplicaSet
          if:
            type: function
            name: mongoTypeEqualsTo|replicaSet|compute
          showLabels: true
          # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet
          elements:
            - type: label-element
              label: Resource Diff Percentage 
              subtitle: Defines the threshold for resource usage variation (in percentage) that triggers scaling actions to maintain optimal performance 
            - type:  threshold-input
              label: Resource Diff Percentage (Integer only)
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/resourceDiffPercentage
              customClass: width-300
            - type: label-element
              label: Resource Configuration
              subtitle: Define minimum and maximum allowed resources to ensure optimal database performance
            - type: block-layout
              showLabels: false
              elements:
                - type: horizontal-layout
                  elements:
                  - type: machine-compare
                    label: Min Allowed Profile
                    schema: temp/properties/allowedMachine-replicaSet-min
                    if:
                      type: function
                      name: hasAnnotations
                    init:
                      type: func
                      value: setAllowedMachine|replicaSet|min
                    loader:
                      name: getMachines|replicaSet|min
                      watchPaths:
                        - temp/properties/topologyMachines
                        - temp/properties/allowedMachine-replicaSet-max
                    watcher:
                      func: onMachineChange|replicaSet
                      paths:
                        - temp/properties/allowedMachine-replicaSet-min
                  - type: block-layout
                    label: Min Allowed
                    if:
                      type: function
                      name: hasNoAnnotations
                    showLabels: true
                    elements:
                      - type: input-compare
                        label: Cpu
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/minAllowed/properties/cpu
                      - type: input-compare
                        label: Memory
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/minAllowed/properties/memory
                  - type: machine-compare
                    label: Max Allowed Profile
                    schema: temp/properties/allowedMachine-replicaSet-max
                    if:
                      type: function
                      name: hasAnnotations
                    init:
                      type: func
                      value: setAllowedMachine|replicaSet|max
                    loader:
                      name: getMachines|replicaSet|max
                      watchPaths:
                        - temp/properties/topologyMachines
                        - temp/properties/allowedMachine-replicaSet-min
                    watcher:
                      func: onMachineChange|replicaSet
                      paths:
                        - temp/properties/allowedMachine-replicaSet-max
                  - type: block-layout
                    label: Max Allowed
                    if:
                      type: function
                      name: hasNoAnnotations
                    showLabels: true
                    elements:
                      - type: input-compare
                        label: Cpu
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/maxAllowed/properties/cpu
                      - type: input-compare
                        label: Memory
                        schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/maxAllowed/properties/memory
            - type: select
              label: Controlled Resources
              loader: setControlledResources|compute/replicaSet
              multiple: true
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/controlledResources
            - type: select
              label: Container Controlled Values
              options:
                - text: Requests And Limits
                  value: RequestsAndLimits
                - text: Requests Only
                  value: RequestsOnly
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/containerControlledValues
            - type: block-layout
              label: In Memory Storage
              showLabels: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/inMemoryStorage
              elements:
                - type: threshold-input
                  label: Scaling Factor Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/inMemoryStorage/properties/scalingFactorPercentage
                - type: threshold-input
                  label: Usage Threshold Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/replicaSet/properties/inMemoryStorage/properties/usageThresholdPercentage
        # type sharded
        - type: block-layout
          showLabels: false
          if:
            type: function
            name: mongoTypeEqualsTo|sharded|compute
          elements:
            - type: block-layout
              label: Shard
              showLabels: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard
              elements:
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/shard/trigger
                  options:
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/trigger
                - type: input
                  label: Pod LifeTime Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/podLifeTimeThreshold
                - type: threshold-input
                  label: Resource Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/resourceDiffPercentage
                - type: label-element
                  label: Resource Limits
                  subtitle: Set minimum and maximum CPU and memory limits for your database pods to ensure optimal resource allocation and prevent over or under provisioning
                - type: block-layout
                  showLabels: false
                  elements:
                    - type: horizontal-layout
                      elements:
                      - type: machine-compare
                        label: Min Allowed Profile
                        schema: temp/properties/allowedMachine-shard-min
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|shard|min
                        loader:
                          name: getMachines|shard|min
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-shard-max
                        watcher:
                          func: onMachineChange|shard
                          paths:
                            - temp/properties/allowedMachine-shard-min
                      - type: block-layout
                        label: Min Allowed
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/minAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/minAllowed/properties/memory
                      - type: machine-compare
                        label: Max Allowed Profile
                        schema: temp/properties/allowedMachine-shard-max
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|shard|max
                        loader:
                          name: getMachines|shard|max
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-shard-min
                        watcher:
                          func: onMachineChange|shard
                          paths:
                            - temp/properties/allowedMachine-shard-max
                      - type: block-layout
                        label: Max Allowed
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/maxAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/maxAllowed/properties/memory
                - type: select
                  label: Controlled Resources
                  loader: setControlledResources|compute/shard
                  multiple: true
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/controlledResources
                - type: select
                  label: Container Controlled Values
                  options: 
                    - text: Requests And Limits
                      value: RequestsAndLimits
                    - text: Requests Only
                      value: RequestsOnly
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/containerControlledValues
                - type: block-layout
                  label: In Memory Storage
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/inMemoryStorage
                  elements:
                    - type: threshold-input
                      label: Scaling Factor Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/inMemoryStorage/properties/scalingFactorPercentage
                    - type: threshold-input
                      label: Usage Threshold Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/shard/properties/inMemoryStorage/properties/usageThresholdPercentage
              
            - type: block-layout
              label: Config Server
              showLabels: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer
              elements:
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/configServer/trigger
                  options:
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/trigger
                - type: input
                  label: Pod LifeTime Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/podLifeTimeThreshold
                - type: threshold-input
                  label: Resource Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/resourceDiffPercentage
                - type: label-element
                  label: Resource Limits
                  subtitle: Set minimum and maximum CPU and memory limits for your database pods to ensure optimal resource allocation and prevent over or under provisioning
                - type: block-layout
                  showLabels: false
                  elements:
                    - type: horizontal-layout
                      elements:
                      - type: machine-compare
                        label: Min Allowed Profile
                        schema: temp/properties/allowedMachine-configServer-min
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|configServer|min
                        loader:
                          name: getMachines|configServer|min
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-configServer-max
                        watcher:
                          func: onMachineChange|configServer
                          paths:
                            - temp/properties/allowedMachine-configServer-min
                      - type: block-layout
                        label: Min Allowed
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/minAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/minAllowed/properties/memory
                      - type: machine-compare
                        label: Max Allowed Profile
                        schema: temp/properties/allowedMachine-configServer-max
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|configServer|max
                        loader:
                          name: getMachines|configServer|max
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-configServer-min
                        watcher:
                          func: onMachineChange|configServer
                          paths:
                            - temp/properties/allowedMachine-configServer-max
                      - type: block-layout
                        label: Max Allowed
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/maxAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/maxAllowed/properties/memory
                - type: select
                  label: Controlled Resources
                  loader: setControlledResources|compute/configServer
                  multiple: true
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/controlledResources
                - type: select
                  label: Container Controlled Values
                  options: 
                    - text: Requests And Limits
                      value: RequestsAndLimits
                    - text: Requests Only
                      value: RequestsOnly
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/containerControlledValues
                - type: block-layout
                  label: In Memory Storage
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/inMemoryStorage
                  elements:
                    - type: threshold-input
                      label: Scaling Factor Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/inMemoryStorage/properties/scalingFactorPercentage
                    - type: threshold-input
                      label: Usage Threshold Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/configServer/properties/inMemoryStorage/properties/usageThresholdPercentage
            - type: block-layout
              label: Arbiter
              showLabels: true
              hideBlock: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter
              elements: 
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/arbiter/trigger
                  options: 
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/trigger
                - type: input
                  label: Pod LifeTime Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/podLifeTimeThreshold
                - type: threshold-input
                  label: Resource Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/resourceDiffPercentage
                - type: block-layout
                  label: Min Allowed
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/minAllowed                 
                  elements:
                    - type: input
                      label: Cpu
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/minAllowed/properties/cpu
                    - type: input
                      label: Memory
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/minAllowed/properties/memory
                   
                - type: block-layout
                  label: Max Allowed
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/maxAllowed
                  elements:
                    - type: input
                      label: Cpu
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/maxAllowed/properties/cpu
                    - type: input
                      label: Memory
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/maxAllowed/properties/memory
                - type: select
                  label: Controlled Resources
                  loader: setControlledResources|compute/arbiter
                  multiple: true
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/controlledResources
                - type: select
                  label: Container Controlled Values
                  options: 
                    - text: Requests And Limits
                      value: RequestsAndLimits
                    - text: Requests Only
                      value: RequestsOnly
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/containerControlledValues
                - type: block-layout
                  label: In Memory Storage
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/inMemoryStorage
                  elements:
                    - type: threshold-input
                      label: Scaling Factor Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/inMemoryStorage/properties/scalingFactorPercentage
                    - type: threshold-input
                      label: Usage Threshold Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/arbiter/properties/inMemoryStorage/properties/usageThresholdPercentage
            - type: block-layout
              label: Hidden
              showLabels: true
              hideBlock: true
              # schema:  schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden
              elements: 
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/hidden/trigger
                  options: 
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/trigger
                - type: input
                  label: Pod LifeTime Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/podLifeTimeThreshold
                - type: threshold-input
                  label: Resource Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/resourceDiffPercentage
                - type: block-layout
                  label: Min Allowed
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/minAllowed                
                  elements:
                    - type: input
                      label: Cpu
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/minAllowed/properties/cpu
                    - type: input
                      label: Memory
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/minAllowed/properties/memory
                - type: block-layout
                  label: Max Allowed
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/maxAllowed
                  elements:
                    - type: input
                      label: Cpu
                      schema:  schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/maxAllowed/properties/cpu
                    - type: input
                      label: Memory
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/maxAllowed/properties/memory
                - type: select
                  label: Controlled Resources
                  loader: setControlledResources|compute/hidden
                  multiple: true
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/controlledResources
                - type: select
                  label: Container Controlled Values
                  options: 
                    - text: Requests And Limits
                      value: RequestsAndLimits
                    - text: Requests Only
                      value: RequestsOnly
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/containerControlledValues
                - type: block-layout
                  label: In Memory Storage
                  showLabels: true
                  # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/inMemoryStorage
                  elements:
                    - type: threshold-input
                      label: Scaling Factor Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/inMemoryStorage/properties/scalingFactorPercentage
                    - type: threshold-input
                      label: Usage Threshold Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/hidden/properties/inMemoryStorage/properties/usageThresholdPercentage
            - type: block-layout
              label: Mongos
              showLabels: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos
              elements:
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/compute/mongos/trigger
                  options:
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/trigger
                - type: input
                  label: Pod LifeTime Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/podLifeTimeThreshold
                - type: threshold-input
                  label: Resource Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/resourceDiffPercentage
                - type: label-element
                  label: Resource Limits
                  subtitle: Set minimum and maximum CPU and memory limits for your database pods to ensure optimal resource allocation and prevent over or under provisioning
                - type: block-layout
                  showLabels: false
                  elements:
                    - type: horizontal-layout
                      elements:
                      - type: machine-compare
                        label: Min Allowed Profile
                        schema: temp/properties/allowedMachine-mongos-min
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|mongos|min
                        loader:
                          name: getMachines|mongos|min
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-mongos-max
                        watcher:
                          func: onMachineChange|mongos
                          paths:
                            - temp/properties/allowedMachine-mongos-min
                      - type: block-layout
                        label: Min Allowed
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/minAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/minAllowed/properties/memory
                      - type: machine-compare
                        label: Max Allowed Profile
                        schema: temp/properties/allowedMachine-mongos-max
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|mongos|max
                        loader:
                          name: getMachines|mongos|max
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-mongos-min
                        watcher:
                          func: onMachineChange|mongos
                          paths:
                            - temp/properties/allowedMachine-mongos-max
                      - type: block-layout
                        label: Max Allowed
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/maxAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/maxAllowed/properties/memory
                - type: select
                  label: Controlled Resources
                  loader: setControlledResources|compute/mongos
                  multiple: true
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/controlledResources
                - type: select
                  label: Container Controlled Values
                  options: 
                    - text: Requests And Limits
                      value: RequestsAndLimits
                    - text: Requests Only
                      value: RequestsOnly
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/containerControlledValues
                - type: block-layout
                  label: In Memory Storage
                  showLabels: true
                  # schema:  schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/inMemoryStorage
                  elements:
                    - type: threshold-input
                      label: Scaling Factor Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/inMemoryStorage/properties/scalingFactorPercentage
                    - type: threshold-input
                      label: Usage Threshold Percentage
                      schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/mongos/properties/inMemoryStorage/properties/usageThresholdPercentage
        - type: block-layout
          label: NodeTopology
          if:
            type: function
            name: hasNoAnnotations
          showLabels: true
          # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/nodeTopology
          elements:
            - type: select
              label: Select NodeTopology
              loader: fetchNodeTopology
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/nodeTopology/properties/name
            - type: threshold-input
              label: Scale Up DiffPercentage
              if:
                type: function
                name: isNodeTopologySelected
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/nodeTopology/properties/scaleUpDiffPercentage
            - type: threshold-input
              label: Scale Down DiffPercentage
              if:
                type: function
                name: isNodeTopologySelected
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/compute/properties/nodeTopology/properties/scaleDownDiffPercentage
        - type: block-layout
          label: Ops Request Options
          showLabels: true
          if:
            type: function
            name: showOpsRequestOptions
          # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions
          elements:
            - type: block-layout
              label: Readiness Criteria
              showLabels: true
              # schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/readinessCriteria
              elements:
                - type: threshold-input
                  label: Objects Count Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/readinessCriteria/properties/objectsCountDiffPercentage
                - type: input
                  label: Oplog Max Lag Seconds
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/readinessCriteria/properties/oplogMaxLagSeconds
            - type: time-picker
              label: Timeout
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/timeout
            - type: radio
              label: Apply
              init:
                type: func
                value: setApplyToIfReady
              options:
                - text: IfReady (OpsRequest will be applied if database is ready)
                  value: IfReady
                - text: Always (OpsRequest will always be applied)
                  value: Always
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/apply

  - type: single-step-form
    id: storage-autoscaler
    loader: getDbDetails
    elements:
    - type: block-layout
      showLabels: false
      elements:
        # standalone mode
        - type: block-layout
          label: Standalone
          if:
            type: function
            name: mongoTypeEqualsTo|standalone|storage
          showLabels: true
          elements:
            - type: select
              label: Trigger
              init:
                type: func
                value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/storage/standalone/trigger
              options:
                - text: 'On'
                  value: 'On'
                - text: 'Off'
                  value: 'Off'
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/trigger
            - type: select
              label: Expansion Mode
              options:
                - text: Online
                  value: Online
                - text: Offline
                  value: Offline
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/expansionMode
            - type: threshold-input
              label: UsageThreshold (%)
              description: hdhdhd
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/usageThreshold
            - type: scaling-rules
              label: Scaling Rules
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/scalingRules
              loader: setValueFromDbDetails|resources/kubedbComMongoDB/spec/storage/resources/requests/storage
              watcher:
                func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/standalone/scalingRules|scalingRules
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/satandalone/properties/scalingRules
            - type: input
              label: Scaling Threshold
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/scalingThreshold
            - type: input
              label: UpperBound
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/upperBound
              watcher:
                func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/standalone/upperBound
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/standalone/properties/upperBound
        # replicaset mode
        - type: block-layout
          label: ReplicaSet
          if:
            type: function
            name: mongoTypeEqualsTo|replicaSet|storage
          showLabels: true
          elements:
            - type: switch
              label: Trigger
              fullwidth: true
              init:
                type: func
                value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/storage/replicaSet/trigger
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/trigger
            - type: label-element
              label: Expansion Mode (Online/Offline)
              subtitle: For Online Mode enables scaling without downtime by dynamically resizing storage while the database remains operational and Offline Mode performs storage scaling during scheduled downtime, ensuring consistency but requiring database restarts.
            - type: select
              label: Mode
              description: Select how the storage expansion should be handled.
              options:
                - text: Online
                  value: Online
                - text: Offline
                  value: Offline
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/expansionMode
            - type: threshold-input
              label: UsageThreshold (%)
              subtitle: Set the threshold percentage of storage usage to trigger scaling.
              customClass: width-300
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/usageThreshold
            - type: scaling-rules
              label: Scaling Rules
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/scalingRules
              loader: setValueFromDbDetails|resources/kubedbComMongoDB/spec/storage/resources/requests/storage
              watcher:
                func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/replicaSet/scalingRules|scalingRules
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/scalingRules
            - type: input
              label: Scaling Threshold
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/scalingThreshold
            - type: input
              label: UpperBound
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/upperBound
              watcher:
                func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/replicaSet/upperBound
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/replicaSet/properties/upperBound
        # sharded mode
        - type: block-layout
          showLabels: false
          if:
            type: function
            name: mongoTypeEqualsTo|sharded|storage
          elements:
            - type: block-layout
              label: Shard
              showLabels: true
              elements:
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/storage/shard/trigger
                  options:
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/trigger
                - type: select
                  label: Expansion Mode
                  options:
                    - text: Online
                      value: Online
                    - text: Offline
                      value: Offline
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/expansionMode
                - type: threshold-input
                  label: UsageThreshold (%)
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/usageThreshold
                - type: scaling-rules
                  label: Scaling Rules
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/scalingRules
                  loader: setValueFromDbDetails|resources/kubedbComMongoDB/spec/shardTopology/shard/storage/resources/requests/storage
                  watcher:
                    func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/shard/scalingRules|scalingRules
                    paths:
                      - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/scalingRules
                - type: input
                  label: UpperBound
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/upperBound
                  watcher:
                    func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/shard/upperBound
                    paths:
                      - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/upperBound
                - type: input
                  label: Scaling Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/shard/properties/scalingThreshold
            - type: block-layout
              label: Config Server
              showLabels: true
              elements:
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/storage/configServer/trigger
                  options:
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/trigger
                - type: select
                  label: Expansion Mode
                  options:
                    - text: Online
                      value: Online
                    - text: Offline
                      value: Offline
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/expansionMode
                - type: threshold-input
                  label: UsageThreshold (%)
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/usageThreshold
                - type: scaling-rules
                  label: Scaling Rules
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/scalingRules
                  loader: setValueFromDbDetails|resources/kubedbComMongoDB/spec/shardTopology/configServer/storage/resources/requests/storage
                  watcher:
                    func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/configServer/scalingRules|scalingRules
                    paths:
                      - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/scalingRules
                - type: input
                  label: UpperBound
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/upperBound
                  watcher:
                    func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/configServer/upperBound
                    paths:
                      - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/upperBound
                - type: input
                  label: Scaling Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/configServer/properties/scalingThreshold
            - type: block-layout
              label: Hidden
              showLabels: true
              elements:
                - type: select
                  label: Trigger
                  init:
                    type: func
                    value: setTrigger|autoscalingKubedbComMongoDBAutoscaler/spec/storage/hidden/trigger
                  options:
                    - text: 'On'
                      value: 'On'
                    - text: 'Off'
                      value: 'Off'
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/trigger
                - type: select
                  label: Expansion Mode
                  options:
                    - text: Online
                      value: Online
                    - text: Offline
                      value: Offline
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/expansionMode
                - type: threshold-input
                  label: UsageThreshold (%)
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/usageThreshold
                - type: scaling-rules
                  label: Scaling Rules
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/scalingRules
                  loader: setValueFromDbDetails|resources/kubedbComMongoDB/spec/shardTopology/hidden/storage/resources/requests/storage
                  watcher:
                    func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/hidden/scalingRules|scalingRules
                    paths:
                      - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/scalingRules
                - type: input
                  label: UpperBound
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/upperBound
                  watcher:
                    func: handleUnit|autoscalingKubedbComMongoDBAutoscaler/spec/storage/hidden/upperBound
                    paths:
                      - schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/upperBound
                - type: input
                  label: Scaling Threshold
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/storage/properties/hidden/properties/scalingThreshold
        - type: block-layout
          label: Ops Request Options
          showLabels: true
          if:
            type: function
            name: showOpsRequestOptions
          elements:
            - type: block-layout
              label: Readiness Criteria
              showLabels: true
              elements:
                - type: threshold-input
                  label: Objects Count Diff Percentage
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/readinessCriteria/properties/objectsCountDiffPercentage
                - type: input
                  label: Oplog Max Lag Seconds
                  schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/readinessCriteria/properties/oplogMaxLagSeconds
            - type: time-picker
              label: Timeout
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/timeout
            - type: radio
              label: Apply
              init:
                type: func
                value: setApplyToIfReady
              options:
                - text: IfReady (OpsRequest will be applied if database is ready)
                  value: IfReady
                - text: Always (OpsRequest will always be applied)
                  value: Always
              schema: schema/properties/resources/properties/autoscalingKubedbComMongoDBAutoscaler/properties/spec/properties/opsRequestOptions/properties/apply

  - type: single-step-form
    id: binding
    label: Gateway Binding
    elements:
    - type: switch
      label: Expose Database
      schema: temp/properties/binding
      fullwidth: true
      init:
        type: func
        value: isBindingAlreadyOn
      watcher:
        func: addOrRemoveBinding
        paths:
          - temp/properties/binding