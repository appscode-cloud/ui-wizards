step:
- type: single-step-form
  loader: initBundle
  elements:
  - disableUnselect: true
    loader: getAdminOptions|databases/Redis/versions
    if:
      type: function
      name: isToggleOn|databases/Redis/versions
    label: Database Version
    schema: schema/properties/spec/properties/admin/properties/databases/properties/Redis/properties/versions/properties/default
    type: select
  - init:
      type: func
      value: getDefault|databases/Redis/mode
    loader: getAdminOptions|databases/Redis/mode
    isHorizontal: true
    if:
      type: function
      name: isToggleOn|databases/Redis/mode
    label: Database Mode
    schema: schema/properties/spec/properties/mode
    type: radio
  - if:
      type: function
      name: isEqualToModelPathValue|Cluster|/spec/mode
    label: Shards
    schema: schema/properties/spec/properties/cluster/properties/master
    type: input
  - if:
      type: function
      name: isEqualToModelPathValue|Cluster|/spec/mode
    label: Replica Number
    schema: schema/properties/spec/properties/cluster/properties/replicas
    type: input
  - elements:
    - init:
        type: func
        value: returnTrue
      label: Sentinel Type
      watcher:
        func: onCreateSentinelChange
        paths:
          - temp/createSentinel
      options:
      - text: Use Existing Sentinel
        value: "false"
      - text: Create New Sentinel
        value: "true"
      schema: temp/createSentinel
      type: radio
    - loader: getResources|core|v1|namespaces
      if:
        type: function
        name: showSentinelNameAndNamespace
      label: Namespace
      schema: schema/properties/spec/properties/sentinelRef/properties/namespace
      type: select
    - loader: getRedisSentinels
      if:
        type: function
        name: showSentinelNameAndNamespace
      label: Name
      schema: schema/properties/spec/properties/sentinelRef/properties/name
      type: select
    - label: Replica Number
      schema: schema/properties/spec/properties/replicas
      type: input
    if:
      type: function
      name: isEqualToModelPathValue|Sentinel|/spec/mode
    type: block-layout
  - elements:
    - init:
        type: func
        value: setMachineToCustom
      loader: getMachineListForOptions
      label: Machine
      schema: schema/properties/spec/properties/podResources/properties/machine
      type: select
    - init:
        type: func
        value: setLimits|cpu
      disable: isMachineNotCustom
      if:
        type: function
        name: isMachineCustom
      label: CPU
      watcher:
        func: setRequests|cpu
        paths:
          - schema/properties/spec/properties/podResources/properties/resources/properties/requests/properties/cpu
      schema: schema/properties/spec/properties/podResources/properties/resources/properties/requests/properties/cpu
      type: input
    - init:
        type: func
        value: setLimits|memory
      disable: isMachineNotCustom
      if:
        type: function
        name: isMachineCustom
      label: Memory
      watcher:
        func: setRequests|memory
        paths:
          - schema/properties/spec/properties/podResources/properties/resources/properties/requests/properties/memory
      schema: schema/properties/spec/properties/podResources/properties/resources/properties/requests/properties/memory
      type: input
    if:
      type: function
      name: notEqualToDatabaseMode|Sharded
    label: Machine profile
    showLabels: true
    type: block-layout
  - loader: getAdminOptions|storageClasses
    label: Storage Class
    schema: schema/properties/spec/properties/admin/properties/storageClasses/properties/default
    type: select
  - if:
      type: function
      name: isNotEqualToModelPathValue|Sentinel|/spec/mode
    label: Storage Size
    schema: schema/properties/spec/properties/persistence/properties/size
    type: input
  - init:
      type: func
      value: setAnnounce
    label: Announce Redis Endpoints ?
    watcher:
      func: setAnnounce
      paths:
        - temp/announce
    schema: temp/announce
    type: switch
  - elements:
    - label: Type
      options:
      - text: ip
        value: ip
      - text: hostname
        value: hostname
      schema: schema/properties/spec/properties/cluster/properties/announce/properties/type
      type: select
    - type: array-item-form
      element:
        label: Shard Endpoints (comma-separated, e.g. "endpoint1,endpoint2,endpoint3")
        schema: schema/properties/spec/properties/cluster/properties/announce/properties/shards/items
        type: input
      label: Shards
      schema: schema/properties/spec/properties/cluster/properties/announce/properties/shards
    if:
      type: function
      name: showAnnounce
    label: Announce
    showLabels: true
    type: block-layout
  - description: Configure Credentials, Deployment Mode etc.
    elements:
    - elements:
      - type: object-item
        label: Labels
        schema: schema/properties/spec/properties/labels/additionalProperties
      - type: object-item
        label: Annotations
        schema: schema/properties/spec/properties/annotations/additionalProperties
      hideBlock: true
      label: Labels & Annotations
      showLabels: true
      type: block-layout
    - init:
        type: func
        value: getDefault|deletionPolicy
      customClass: mt-20
      if:
        type: function
        name: isToggleOn|deletionPolicy
      label: Deletion Policy
      watcher:
        func: setStorageClass
        paths:
          - schema/properties/spec/properties/deletionPolicy
      options:
      - description: options.deletionPolicy.delete.description
        text: Delete ( Keep only database Secrets and backed up data )
        value: Delete
      - description: options.deletionPolicy.halt.description
        text: Halt ( Keep PVCs, database Secrets and backed up data )
        value: Halt
      - description: options.deletionPolicy.wipeOut.description
        text: WipeOut ( Delete everything including backed up data )
        value: WipeOut
      - description: options.deletionPolicy.doNotTerminate.description
        text: DoNotTerminate ( Prevent deletion of the Redis CRD )
        value: DoNotTerminate
      schema: schema/properties/spec/properties/deletionPolicy
      type: select
    - if:
        type: function
        name: getDefaultValue|spec/admin/authCredential/customize
      label: Provide Authentication Credentials?
      watcher:
        func: onAuthChange
        paths:
          - temp/createAuthSecret
      schema: temp/createAuthSecret
      type: switch
    - if:
        type: function
        name: showReferSecretSwitch
      label: Refer existing Secret?
      watcher:
        func: onReferSecretChange
        paths:
          - temp/referSecret
      schema: temp/referSecret
      type: switch
    - loader: getReferSecrets
      if:
        type: function
        name: showSecretDropdown
      label: Secret
      schema: schema/properties/spec/properties/authSecret/properties/name
      type: select
    - if:
        type: function
        name: showReferSecret
      label: Password (leave it blank to auto generate password)
      schema: schema/properties/spec/properties/authSecret/properties/password
      type: input
    - init:
        type: func
        value: isConfigAvailable
      if:
        type: function
        name: getDefaultValue|spec/admin/customConfiguration
      label: Configure Database?
      watcher:
        func: clearConfiguration
        paths:
          - temp/configDatabase
      schema: temp/configDatabase
      type: switch
    - if:
        type: function
        name: isConfigDatabaseOn
      label: Configuration
      schema: schema/properties/spec/properties/configuration
      type: textarea
    - if:
        type: function
        name: isToggleOn|deployment
      label: Deployment Mode
      options:
      - description: For exploring databases when high-performance is not required.
        text: Shared
        value: Shared
      - description: For production applications with sophisticated workload
        text: Dedicated
        value: Dedicated
      schema: schema/properties/spec/properties/admin/properties/deployment/properties/default
      type: radio
    - if:
        type: function
        name: isToggleOn|clusterTier
      isHorizontal: true
      label: Cluster Tier
      options:
      - text: General Purpose
        value: GeneralPurpose
      - text: Memory Optimized
        value: MemoryOptimized
      - text: CPU Optimized
        value: CPUOptimized
      schema: schema/properties/spec/properties/admin/properties/clusterTier/properties/default
      type: radio
    - disableUnselect: true
      loader: getAdminOptions|clusterTier/placement
      if:
        type: function
        name: isToggleOn|clusterTier/placement
      label: Placement Policy
      schema: schema/properties/spec/properties/admin/properties/clusterTier/properties/placement/properties/default
      type: select
    - disableUnselect: true
      loader: getNodeTopology
      if:
        type: function
        name: isToggleOn|clusterTier/nodeTopology
      label: Node Topology
      schema: schema/properties/spec/properties/admin/properties/clusterTier/properties/nodeTopology/properties/default
      type: select
    hideBlock: true
    label: Advanced Configuration
    showLabels: true
    type: block-layout
  - description: Enable Backup, Monitoring, TLS etc.
    elements:
    - elements:
      - init:
          type: func
          value: setMonitoring
        label: Enable Monitoring
        watcher:
          func: updateAlertValue
          paths:
            - temp/monitoring
        schema: temp/monitoring
        type: switch
      - customClass: mt-10
        if:
          type: function
          name: showAlerts
        label: Alert Options
        options:
        - text: None
          value: none
        - text: Critical
          value: critical
        - text: Warning
          value: warning
        - text: Info
          value: info
        schema: schema/properties/form/properties/alert/properties/enabled
        type: select
      if:
        type: function
        name: isToggleOn|monitoring
      type: block-layout
    - init:
        type: func
        value: setBackup
      if:
        type: function
        name: isToggleOn|backup
      label: Enable Backup?
      watcher:
        func: onBackupSwitch
        paths:
          - temp/backup
      schema: temp/backup
      type: switch
    - elements:
      - label: Enable TLS?
        schema: schema/properties/spec/properties/admin/properties/tls/properties/default
        type: switch
      - loader: getAdminOptions|clusterIssuers
        if:
          type: function
          name: showIssuer
        label: Cluster Issuers
        validation:
          type: required
        schema: schema/properties/spec/properties/admin/properties/clusterIssuers/properties/default
        type: select
      if:
        type: function
        name: isToggleOn|tls
      type: block-layout
    - elements:
      - if:
          type: function
          name: isToggleOn|expose
        label: Expose via Gateway?
        schema: schema/properties/spec/properties/admin/properties/expose/properties/default
        type: switch
      type: block-layout
    if:
      type: function
      name: showAdditionalSettings
    label: Additional Options
    showLabels: true
    type: block-layout
  id: options
  # title: steps.0.label
type: multi-step-form
