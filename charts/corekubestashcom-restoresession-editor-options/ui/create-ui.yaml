steps:
- form:
    elements:
    - computed: setTarget
      if: returnFalse
      schema:
        $ref: discriminator#/addons
      type: input
    - elements:
      - elements:
        - fetch: getNamespaces
          label:
            text: labels.namespace
          schema:
            $ref: schema#/properties/spec/properties/dataSource/properties/repository/properties/namespace
          type: select
        - fetch: fetchNames|repository
          label:
            text: labels.name
          schema:
            $ref: schema#/properties/spec/properties/dataSource/properties/repository/properties/name
          type: select
        label:
          text: labels.dataSource.repository
        schema:
          $ref: schema#/properties/spec/properties/dataSource/properties/repository
        show_label: true
        type: single-step-form
      - fetch: getSnapshots
        label:
          text: labels.dataSource.snapshot
        schema:
          $ref: schema#/properties/spec/properties/dataSource/properties/snapshot
        type: select
      - elements:
        - fetch: getNamespaces
          label:
            text: labels.namespace
          schema:
            $ref: schema#/properties/spec/properties/dataSource/properties/encryptionSecret/properties/namespace
          type: select
        - fetch: fetchNames|encryptionSecret
          label:
            text: labels.name
          schema:
            $ref: schema#/properties/spec/properties/dataSource/properties/encryptionSecret/properties/name
          type: select
        label:
          text: labels.dataSource.encryptionSecret
        schema:
          $ref: schema#/properties/spec/properties/dataSource/properties/encryptionSecret
        show_label: true
        type: single-step-form
      schema:
        $ref: schema#/properties/spec/properties/dataSource
      type: single-step-form
    - discriminator:
        task:
          default: ""
          type: string
      elements:
      - fetch: getAddons
        label:
          text: labels.addon
        schema:
          $ref: schema#/properties/spec/properties/addon/properties/name
        type: select
      - fetch: getTasks
        label:
          text: labels.tasks
        onChange: setTask
        schema:
          $ref: discriminator#/properties/task
        type: select
      schema:
        $ref: schema#/properties/spec/properties/addon
      type: single-step-form
    schema:
      $ref: schema#/properties/spec
    type: single-step-form
  id: options
  title: steps.0.label
type: multi-step-form
