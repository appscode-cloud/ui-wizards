type: multi-step-form
step:
- type: single-step-form
  id: options
  loader: init
  elements:
    - type: select
      label: Select Namespace
      schema: schema/properties/metadata/properties/release/properties/namespace
      hasGroup: isRancherManaged
      if:
        type: function
        name: isConsole
      loader:
        name: fetchNamespaces
        watchPaths:
          - temp/properties/nameSpaceApi
    - type: input
      label: Name
      schema: schema/properties/metadata/properties/release/properties/name
      if:
        type: function
        name: isConsole
    - type: block-layout
      showLabels: false
      loader: initMetadata
      elements:
        - type: select
          label: Repository
          disableUnselect: true
          schema: temp/properties/repository
          refresh: true
          validation: 
            type: required
          loader: getRepositories
        - type: select
          disableUnselect: true
          label: Snapshot
          refresh: true
          schema: schema/properties/spec/properties/dataSource/properties/snapshot
          loader:
            name: getSnapshots
            watchPaths:
              - temp/properties/repository
          watcher:
            func: onRepoChange
            paths:
              - temp/properties/repository
        - type: select
          label: Name
          refresh: true
          schema: schema/properties/spec/properties/addon/properties/name
          if:
            type: function
            name: isConsole
          loader: getAddons
        - type: textarea
          label: Additional Parameters
          schema: temp/properties/params
          watcher:
            func: onParameterChange
            paths:
              - temp/properties/params
    - type: block-layout
      showLabels: true
      hideBlock: true
      label: Target
      if:
        type: function
        name: isConsole
      elements:
      - type: select
        label: Api Group
        schema: schema/properties/spec/properties/target/properties/apiGroup
        loader: getApiGroup
      - type: select
        label: Kind
        schema: schema/properties/spec/properties/target/properties/kind
        loader: getKinds
        watcher:
          func: setVersion
          paths:
            - schema/properties/spec/properties/target/properties/kind
            - schema/properties/spec/properties/target/properties/apiGroup
      - type: select
        label: Namespace
        schema: schema/properties/spec/properties/target/properties/namespace
        loader: fetchNamespaces
        hasGroup: isRancherManaged
        watcher:
          func: fetchNamespaces
          paths:
            - temp/properties/nameSpaceApi
      - type: select
        label: Name
        schema: schema/properties/spec/properties/target/properties/name
        loader:
          name: getTargetName
          watchPaths:
            - schema/properties/spec/properties/target/properties/apiGroup
            - schema/properties/spec/properties/target/properties/namespace
            - schema/properties/spec/properties/target/properties/kind
