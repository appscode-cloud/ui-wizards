step:
- type: single-step-form
  elements:
  - init:
      type: func
      value: initBundle
    if:
      type: function
      name: returnFalse
    label: ''
    type: label-element
  - disableUnselect: true
    loader: getAdminOptions|databases/Druid/versions
    if:
      type: function
      name: isToggleOn|databases/Druid/versions
    label: labels.database.version
    schema: schema/properties/spec/properties/admin/properties/databases/properties/Druid/properties/versions/properties/default
    type: select
  - elements:
    - elements:
      - label: labels.storage.size
        schema: schema/properties/spec/properties/topology/properties/middleManagers/properties/persistence/properties/size
        type: input
      - label: labels.replicaset.number
        schema: schema/properties/spec/properties/topology/properties/middleManagers/properties/replicas
        type: input
      - init:
          type: func
          value: setMachineToCustom
        loader: getMachineListForOptions
        label: Machine
        schema: schema/properties/spec/properties/topology/properties/middleManagers/properties/podResources/properties/machine
        type: select
      - init:
          type: func
          value: setLimits|cpu|topology/middleManagers
        disable: isMachineNotCustom|topology/middleManagers
        if:
          type: function
          name: isMachineCustom|topology/middleManagers
        label: labels.cpu
        watcher:
          func: setRequests|cpu|topology/middleManagers
          paths:
            - schema/properties/spec/properties/topology/properties/middleManagers/properties/podResources/properties/resources/properties/requests/properties/cpu
        schema: schema/properties/spec/properties/topology/properties/middleManagers/properties/podResources/properties/resources/properties/requests/properties/cpu
        type: input
      - init:
          type: func
          value: setLimits|memory|topology/middleManagers
        disable: isMachineNotCustom|topology/middleManagers
        if:
          type: function
          name: isMachineCustom|topology/middleManagers
        label: labels.memory
        watcher:
          func: setRequests|memory|topology/middleManagers
          paths:
            - schema/properties/spec/properties/topology/properties/middleManagers/properties/podResources/properties/resources/properties/requests/properties/memory
        schema: schema/properties/spec/properties/topology/properties/middleManagers/properties/podResources/properties/resources/properties/requests/properties/memory
        type: input
      label: labels.middleManagers
      showLabels: true
      type: block-layout
    - elements:
      - label: labels.storage.size
        schema: schema/properties/spec/properties/topology/properties/historicals/properties/persistence/properties/size
        type: input
      - label: labels.replicaset.number
        schema: schema/properties/spec/properties/topology/properties/historicals/properties/replicas
        type: input
      - init:
          type: func
          value: setMachineToCustom
        loader: getMachineListForOptions
        label: Machine
        schema: schema/properties/spec/properties/topology/properties/historicals/properties/podResources/properties/machine
        type: select
      - init:
          type: func
          value: setLimits|cpu|topology/historicals
        disable: isMachineNotCustom|topology/historicals
        if:
          type: function
          name: isMachineCustom||topology/historicals
        label: labels.cpu
        watcher:
          func: setRequests|cpu|topology/historicals
          paths:
            - schema/properties/spec/properties/topology/properties/historicals/properties/podResources/properties/resources/properties/requests/properties/cpu
        schema: schema/properties/spec/properties/topology/properties/historicals/properties/podResources/properties/resources/properties/requests/properties/cpu
        type: input
      - init:
          type: func
          value: setLimits|memory|topology/historicals
        disable: isMachineNotCustom|topology/historicals
        if:
          type: function
          name: isMachineCustom||topology/historicals
        label: labels.memory
        watcher:
          func: setRequests|memory|topology/historicals
          paths:
            - schema/properties/spec/properties/topology/properties/historicals/properties/podResources/properties/resources/properties/requests/properties/memory
        schema: schema/properties/spec/properties/topology/properties/historicals/properties/podResources/properties/resources/properties/requests/properties/memory
        type: input
      label: labels.historicals
      showLabels: true
      type: block-layout
    - elements:
      - label: labels.replicaset.number
        schema: schema/properties/spec/properties/topology/properties/brokers/properties/replicas
        type: input
      - init:
          type: func
          value: setMachineToCustom
        loader: getMachineListForOptions
        label: Machine
        schema: schema/properties/spec/properties/topology/properties/brokers/properties/podResources/properties/machine
        type: select
      - init:
          type: func
          value: setLimits|cpu|topology/brokers
        disable: isMachineNotCustom|topology/brokers
        if:
          type: function
          name: isMachineCustom|topology/brokers
        label: labels.cpu
        watcher:
          func: setRequests|cpu|topology/middleManagers
          paths:
            - schema/properties/spec/properties/topology/properties/brokers/properties/podResources/properties/resources/properties/requests/properties/cpu
        schema: schema/properties/spec/properties/topology/properties/brokers/properties/podResources/properties/resources/properties/requests/properties/cpu
        type: input
      - init:
          type: func
          value: setLimits|memory|topology/brokers
        disable: isMachineNotCustom|topology/brokers
        if:
          type: function
          name: isMachineCustom|topology/brokers
        label: labels.memory
        watcher:
          func: setRequests|memory|topology/brokers
          paths:
            - schema/properties/spec/properties/topology/properties/brokers/properties/podResources/properties/resources/properties/requests/properties/memory
        schema: schema/properties/spec/properties/topology/properties/brokers/properties/podResources/properties/resources/properties/requests/properties/memory
        type: input
      label: labels.brokers
      showLabels: true
      type: block-layout
    - elements:
      - label: labels.replicaset.number
        schema: schema/properties/spec/properties/topology/properties/coordinators/properties/replicas
        type: input
      - init:
          type: func
          value: setMachineToCustom
        loader: getMachineListForOptions
        label: Machine
        schema: schema/properties/spec/properties/topology/properties/coordinators/properties/podResources/properties/machine
        type: select
      - init:
          type: func
          value: setLimits|cpu|topology/coordinators
        disable: isMachineNotCustom|topology/coordinators
        if:
          type: function
          name: isMachineCustom|topology/coordinators
        label: labels.cpu
        watcher:
          func: setRequests|cpu|topology/middleManagers
          paths:
            - schema/properties/spec/properties/topology/properties/coordinators/properties/podResources/properties/resources/properties/requests/properties/cpu
        schema: schema/properties/spec/properties/topology/properties/coordinators/properties/podResources/properties/resources/properties/requests/properties/cpu
        type: input
      - init:
          type: func
          value: setLimits|memory|topology/coordinators
        disable: isMachineNotCustom|topology/coordinators
        if:
          type: function
          name: isMachineCustom|topology/coordinators
        label: labels.memory
        watcher:
          func: setRequests|memory|topology/coordinators
          paths:
            - schema/properties/spec/properties/topology/properties/coordinators/properties/podResources/properties/resources/properties/requests/properties/memory
        schema: schema/properties/spec/properties/topology/properties/coordinators/properties/podResources/properties/resources/properties/requests/properties/memory
        type: input
      label: labels.coordinators
      showLabels: true
      type: block-layout
    type: block-layout
  - customClass: mt-10
    loader: getAdminOptions|storageClasses
    if:
      type: function
      name: isToggleOn|storageClasses
    label: labels.storage.class
    schema: schema/properties/spec/properties/admin/properties/storageClasses/properties/default
    type: select
  - label: labels.deepStorage
    options:
    - s3
    - google
    - azure
    - hdfs
    schema: schema/properties/spec/properties/deepStorage/properties/type
    type: select
  - loader: getSecrets
    label: labels.configSecret
    refresh: true
    schema: schema/properties/spec/properties/deepStorage/properties/configSecret
    type: select
  - description: Configure Credentials, Deployment Mode etc.
    elements:
    - elements:
      - type: object-item
        label: labels.labels.label
        schema: schema/properties/spec/properties/labels/additionalProperties
      - type: object-item
        label: labels.annotations.label
        schema: schema/properties/spec/properties/annotations/additionalProperties
      label: Labels & Annotations
      showLabels: true
      type: block-layout
    - init:
        type: func
        value: getDefault|deletionPolicy
      customClass: mt-20
      if:
        type: function
        name: isToggleOn|deletionPolicy
      label: labels.deletionPolicy
      watcher:
        func: setStorageClass
        paths:
          - schema/properties/spec/properties/deletionPolicy
      options:
      - description: options.deletionPolicy.delete.description
        text: options.deletionPolicy.delete.label
        value: Delete
      - description: options.deletionPolicy.halt.description
        text: options.deletionPolicy.halt.label
        value: Halt
      - description: options.deletionPolicy.wipeOut.description
        text: options.deletionPolicy.wipeOut.label
        value: WipeOut
      - description: options.deletionPolicy.doNotTerminate.description
        text: options.deletionPolicy.doNotTerminate.label
        value: DoNotTerminate
      schema: schema/properties/spec/properties/deletionPolicy
      type: select
    - label: labels.metadataStorage.external
      schema: schema/properties/spec/properties/metadataStorage/properties/externallyManaged
      type: switch
    - if:
        type: function
        name: isExternallyManaged|metadataStorage
      label: labels.metadataStorage.type
      watcher:
        func: clearRefs|metadataStorage
        paths:
          - schema/properties/spec/properties/metadataStorage/properties/type
      options:
      - text: MySQL
        value: MySQL
      - text: Postgres
        value: Postgres
      schema: schema/properties/spec/properties/metadataStorage/properties/type
      type: select
    - loader: getAppBindings|mysql
      if:
        type: function
        name: isMetadataStorageTypeEqualsTo|MySQL
      label: labels.metadataStorage.mysql
      watcher:
        func: onRefChange|metadataStorage
        paths:
          - temp/metadataStorage
      refresh: true
      validation:
        type: required
      schema: temp/metadataStorage
      type: select
    - loader: getAppBindings|postgres
      if:
        type: function
        name: isMetadataStorageTypeEqualsTo|Postgres
      label: labels.metadataStorage.postgres
      watcher:
        func: onRefChange|metadataStorage
        paths:
          - temp/metadataStorage
      refresh: true
      validation:
        type: required
      schema: temp/metadataStorage
      type: select
    - label: labels.zookeeperRef.external
      schema: schema/properties/spec/properties/zookeeperRef/properties/externallyManaged
      type: switch
    - loader: getAppBindings|zookeeper
      if:
        type: function
        name: isExternallyManaged|zookeeperRef
      label: labels.zookeeperRef.zookeeper
      watcher:
        func: onRefChange|zookeeperRef
        paths:
          - temp/zookeeperRef
      refresh: true
      validation:
        type: required
      schema: temp/zookeeperRef
      type: select
    - if:
        type: function
        name: getDefaultValue|spec/admin/authCredential/customize
      label: Provide Authentication Credentials?
      watcher:
        func: onAuthChange
        paths:
          - temp/createAuthSecret
      schema: temp/createAuthSecret
      type: switch
    - if:
        type: function
        name: showReferSecretSwitch
      label: Refer existing Secret?
      watcher:
        func: onReferSecretChange
        paths:
          - temp/referSecret
      schema: temp/referSecret
      type: switch
    - loader: getReferSecrets
      if:
        type: function
        name: showSecretDropdown
      label: Secret
      schema: schema/properties/spec/properties/authSecret/properties/name
      type: select
    - if:
        type: function
        name: showReferSecret
      label: labels.password
      schema: schema/properties/spec/properties/authSecret/properties/password
      type: input
    - init:
        type: func
        value: isConfigAvailable
      if:
        type: function
        name: getDefaultValue|spec/admin/customConfiguration
      label: Configure Database?
      watcher:
        func: clearConfiguration
        paths:
          - temp/configDatabase
      schema: temp/configDatabase
      type: switch
    - if:
        type: function
        name: isConfigDatabaseOn
      label: Configuration
      hasCopy: true
      schema: schema/properties/spec/properties/configuration
      type: editor
    - if:
        type: function
        name: isToggleOn|deployment
      label: labels.deployment.name
      options:
      - description: labels.deployment.shared
        text: Shared
        value: Shared
      - description: labels.deployment.dedicated
        text: Dedicated
        value: Dedicated
      schema: schema/properties/spec/properties/admin/properties/deployment/properties/default
      type: radio
    - if:
        type: function
        name: isToggleOn|clusterTier
      isHorizontal: true
      label: labels.clusterTier
      options:
      - text: General Purpose
        value: GeneralPurpose
      - text: Memory Optimized
        value: MemoryOptimized
      - text: CPU Optimized
        value: CPUOptimized
      schema: schema/properties/spec/properties/admin/properties/clusterTier/properties/default
      type: radio
    - disableUnselect: true
      loader: getAdminOptions|clusterTier/placement
      if:
        type: function
        name: isToggleOn|clusterTier/placement
      label: labels.placement
      schema: schema/properties/spec/properties/admin/properties/clusterTier/properties/placement/properties/default
      type: select
    - disableUnselect: true
      loader: getNodeTopology
      if:
        type: function
        name: isToggleOn|clusterTier/nodeTopology
      label: labels.nodeTopology
      schema: schema/properties/spec/properties/admin/properties/clusterTier/properties/nodeTopology/properties/default
      type: select
    label: Advanced Configuration
    showLabels: true
    type: block-layout
  - description: Enable Backup, Monitoring, TLS etc.
    elements:
    - elements:
      - init:
          type: func
          value: setMonitoring
        label: labels.enable_monitoring
        watcher:
          func: updateAlertValue
          paths:
            - temp/monitoring
        schema: temp/monitoring
        type: switch
      - customClass: mt-10
        if:
          type: function
          name: showAlerts
        label: labels.alert.options
        options:
        - text: None
          value: none
        - text: Critical
          value: critical
        - text: Warning
          value: warning
        - text: Info
          value: info
        schema: schema/properties/form/properties/alert/properties/enabled
        type: select
      if:
        type: function
        name: isToggleOn|monitoring
      type: block-layout
    - init:
        type: func
        value: setBackup
      if:
        type: function
        name: isToggleOn|backup
      label: Enable Backup?
      watcher:
        func: onBackupSwitch
        paths:
          - temp/backup
      schema: temp/backup
      type: switch
    - elements:
      - label: Expose via Gateway?
        schema: schema/properties/spec/properties/admin/properties/expose/properties/default
        type: switch
      if:
        type: function
        name: isToggleOn|expose
      type: block-layout
    if:
      type: function
      name: showAdditionalSettings
    label: Additional Options
    showLabels: true
    type: block-layout
  id: options
type: multi-step-form
