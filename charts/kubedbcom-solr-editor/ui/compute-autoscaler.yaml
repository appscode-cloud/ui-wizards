  - type: single-step-form
    id: storage-autoscaler
    loader: getDbDetails
    elements:
      - type: block-layout
        if:
         type: function
         name: isConsole
        elements:
          - type: input
            label: Name
            schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/metadata/properties/name
          - type: select
            label: Select Namespace
            loader: getNamespaces
            if:
              type: function
              name: isRancherManaged
            schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/metadata/properties/namespace
            watcher:
              func: onNamespaceChange
              paths:
                - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/metadata/properties/namespace
          - type: select
            label: Select Db
            loader: getDbs
            validation:
              type: required
            refresh: true
            schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/databaseRef/properties/name
            watcher:
              func: initMetadata
              paths:
                - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/databaseRef/properties/name

      - type: radio
        if:
          type: function
          name: isConsole
        label: Select Type
        validation:
          type: required
        schema: temp/properties/autoscalingType
        watcher:
          func: initMetadata
          paths:
            - temp/properties/autoscalingType
        options:
          - text: Compute
            value: compute
            description: Scale your CPU Memory based on resource usage
          - text: Storage
            value: storage
            description: Expand your database size based on volume usage

      - type: block-layout
        showLabels: false
        elements:
          # Storage sections for different node types
          - type: block-layout
            showLabels: false
            elements:
              # Coordinator
              - type: block-layout
                label: Coordinator
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator
                elements:
                  - type: select
                    label: Trigger
                    init:
                      type: func
                      value: setTrigger|autoscalingKubedbComSolrAutoscaler/spec/storage/coordinator/trigger
                    options:
                      - text: 'On'
                        value: 'On'
                      - text: 'Off'
                        value: 'Off'
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/trigger
                  - type: select
                    label: Expansion Mode
                    options:
                      - text: Online
                        value: Online
                      - text: Offline
                        value: Offline
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/expansionMode
                  - type: input
                    label: Usage Threshold (%)
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/usageThreshold
                  - type: single-step-form-array
                    label: Scaling Rules
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/scalingRules
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/coordinator/scalingRules|scalingRules
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/scalingRules
                    addFormLabel: Scaling Rules
                    element:
                      type: single-step-form
                      elements:
                        - type: input
                          label: Applies Upto (In Storage units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/scalingRules/items/properties/appliesUpto
                        - type: input
                          label: Threshold (In %, Or In Storage Units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/scalingRules/items/properties/threshold
                    tableContents:
                      - type: value
                        label: Applies Upto (In Storage units)
                        path: appliesUpto
                        typeOfValue: string
                        inTableColumn: true
                      - type: value
                        label: Threshold (In %, Or In Storage Units)
                        path: threshold
                        typeOfValue: string
                        inTableColumn: true
                  - type: input
                    label: Upper Bound
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/upperBound
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/coordinator/upperBound
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/coordinator/properties/upperBound

              # Data
              - type: block-layout
                label: Data
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data
                elements:
                  - type: select
                    label: Trigger
                    init:
                      type: func
                      value: setTrigger|autoscalingKubedbComSolrAutoscaler/spec/storage/data/trigger
                    options:
                      - text: 'On'
                        value: 'On'
                      - text: 'Off'
                        value: 'Off'
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/trigger
                  - type: select
                    label: Expansion Mode
                    options:
                      - text: Online
                        value: Online
                      - text: Offline
                        value: Offline
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/expansionMode
                  - type: input
                    label: Usage Threshold (%)
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/usageThreshold
                  - type: single-step-form-array
                    label: Scaling Rules
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/scalingRules
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/data/scalingRules|scalingRules
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/scalingRules
                    addFormLabel: Scaling Rules
                    element:
                      type: single-step-form
                      elements:
                        - type: input
                          label: Applies Upto (In Storage units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/scalingRules/items/properties/appliesUpto
                        - type: input
                          label: Threshold (In %, Or In Storage Units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/scalingRules/items/properties/threshold
                    tableContents:
                      - type: value
                        label: Applies Upto (In Storage units)
                        path: appliesUpto
                        typeOfValue: string
                        inTableColumn: true
                      - type: value
                        label: Threshold (In %, Or In Storage Units)
                        path: threshold
                        typeOfValue: string
                        inTableColumn: true
                  - type: input
                    label: Upper Bound
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/upperBound
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/data/upperBound
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/data/properties/upperBound

              # Node
              - type: block-layout
                label: Node
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node
                elements:
                  - type: select
                    label: Trigger
                    init:
                      type: func
                      value: setTrigger|autoscalingKubedbComSolrAutoscaler/spec/storage/node/trigger
                    options:
                      - text: 'On'
                        value: 'On'
                      - text: 'Off'
                        value: 'Off'
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/trigger
                  - type: select
                    label: Expansion Mode
                    options:
                      - text: Online
                        value: Online
                      - text: Offline
                        value: Offline
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/expansionMode
                  - type: input
                    label: Usage Threshold (%)
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/usageThreshold
                  - type: single-step-form-array
                    label: Scaling Rules
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingRules
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/node/scalingRules|scalingRules
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingRules
                    addFormLabel: Scaling Rules
                    element:
                      type: single-step-form
                      elements:
                        - type: input
                          label: Applies Upto (In Storage units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingRules/items/properties/appliesUpto
                        - type: input
                          label: Threshold (In %, Or In Storage Units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingRules/items/properties/threshold
                    tableContents:
                      - type: value
                        label: Applies Upto (In Storage units)
                        path: appliesUpto
                        typeOfValue: string
                        inTableColumn: true
                      - type: value
                        label: Threshold (In %, Or In Storage Units)
                        path: threshold
                        typeOfValue: string
                        inTableColumn: true
                  - type: input
                    label: Upper Bound
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/upperBound
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/node/upperBound
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/node/properties/upperBound

              # Overseer
              - type: block-layout
                label: Overseer
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer
                elements:
                  - type: select
                    label: Trigger
                    init:
                      type: func
                      value: setTrigger|autoscalingKubedbComSolrAutoscaler/spec/storage/overseer/trigger
                    options:
                      - text: 'On'
                        value: 'On'
                      - text: 'Off'
                        value: 'Off'
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/trigger
                  - type: select
                    label: Expansion Mode
                    options:
                      - text: Online
                        value: Online
                      - text: Offline
                        value: Offline
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/expansionMode
                  - type: input
                    label: Usage Threshold (%)
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/usageThreshold
                  - type: single-step-form-array
                    label: Scaling Rules
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/scalingRules
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/overseer/scalingRules|scalingRules
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/scalingRules
                    addFormLabel: Scaling Rules
                    element:
                      type: single-step-form
                      elements:
                        - type: input
                          label: Applies Upto (In Storage units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/scalingRules/items/properties/appliesUpto
                        - type: input
                          label: Threshold (In %, Or In Storage Units)
                          schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/scalingRules/items/properties/threshold
                    tableContents:
                      - type: value
                        label: Applies Upto (In Storage units)
                        path: appliesUpto
                        typeOfValue: string
                        inTableColumn: true
                      - type: value
                        label: Threshold (In %, Or In Storage Units)
                        path: threshold
                        typeOfValue: string
                        inTableColumn: true
                  - type: input
                    label: Upper Bound
                    schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/upperBound
                    watcher:
                      func: handleUnit|autoscalingKubedbComSolrAutoscaler/spec/storage/overseer/upperBound
                      paths:
                        - schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/overseer/properties/upperBound

          # Node Topology
          - type: block-layout
            label: Node Topology
            showLabels: true
            # schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/nodeTopology
            elements:
              - type: select
                label: Select NodeTopology
                loader: fetchNodeTopology
                schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/nodeTopology/properties/name
              - type: input
                label: ScaleUp Diff Percentage
                if:
                  type: function
                  name: isNodeTopologySelected|storage
                schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/nodeTopology/properties/scaleUpDiffPercentage
              - type: input
                label: ScaleDown Diff Percentage
                if:
                  type: function
                  name: isNodeTopologySelected|storage
                schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/storage/properties/nodeTopology/properties/scaleDownDiffPercentage

          # Ops Request Options
          - type: block-layout
            label: Ops Request Options
            showLabels: true
            if:
              type: function
              name: showOpsRequestOptions
            # schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/opsRequestOptions
            elements:
              - type: select
                label: Timeout
                schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/opsRequestOptions/properties/timeout
                options:
                - text: 5 minutes
                  value: 5m0s
                - text: 10 minutes
                  value: 10m0s
                - text: 30 minutes
                  value: 30m0s
                - text: 1 hour
                  value: 1h0m
                - text: 2 hours
                  value: 2h0m
                - text: 5 hours
                  value: 5h0m
                - text: 10 hours
                  value: 10h0m
              - type: radio
                label: Apply
                init:
                  type: func
                  value: setApplyToIfReady
                options:
                  - text: IfReady (OpsRequest will be applied if database is ready)
                    value: IfReady
                  - text: Always (OpsRequest will always be applied)
                    value: Always
                schema: schema/properties/resources/properties/autoscalingKubedbComSolrAutoscaler/properties/spec/properties/opsRequestOptions/properties/apply
