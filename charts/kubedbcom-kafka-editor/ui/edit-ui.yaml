type: multi-step-form
step:
  - type: single-step-form
    id: compute-autoscaler
    loader: getDbDetails
    elements:
      - type: block-layout
        if:
         type: function
         name: isConsole
        elements:
          - type: input
            label: Name
            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/metadata/properties/name
          - type: select
            label: Select Namespace
            loader: getNamespaces
            if:
              type: function
              name: isRancherManaged
            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/metadata/properties/namespace
            watcher:
              func: onNamespaceChange
              paths:
                - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/metadata/properties/namespace
          - type: select
            label: Select Db
            loader: getDbs
            validation:
              type: required
            refresh: true
            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/databaseRef/properties/name
            watcher:
              func: initMetadata
              paths:
                - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/databaseRef/properties/name

      - type: radio
        if:
          type: function
          name: isConsole
        label: Select Type
        validation:
          type: required
        schema: temp/properties/autoscalingType
        watcher:
          func: initMetadata
          paths:
            - temp/properties/autoscalingType
        options:
          - text: Compute
            value: compute
            description: Scale your CPU Memory based on resource usage
          - text: Storage
            value: storage
            description: Expand your database size based on volume usage

      - type: block-layout
        showLabels: false
        loader: fetchTopologyMachines
        elements:
          # topology mode - broker and controller
          - type: block-layout
            label: Topology
            if:
              type: function
              name: dbTypeEqualsTo|topology
            showLabels: false
            # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute
            elements:
              # Broker section
              - type: switch
                label: Trigger
                fullwidth: true
                schema: temp/properties/compute/properties/broker/properties/trigger
                watcher:
                  func: onTriggerChange|compute/broker
                  paths:
                    - temp/properties/compute/properties/broker/properties/trigger
                init:
                  type: func
                  value: setTrigger|autoscalingKubedbComKafkaAutoscaler/spec/compute/broker/trigger
              - type: label-element
                label: Pod lifetime threshold
                subtitle: Specifies the duration a pod can exist before using considered for scaling decisions, ensuring resource optimization and workload stability
              - type: input
                label: Pod LifeTime Threshold (e.g., 10m 30s)
                customClass: width-300
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/podLifeTimeThreshold
              - type: block-layout
                label: Broker
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker
                elements:
                  - type: threshold-input
                    label: ResourceDiff Percentage
                    customClass: width-300
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/resourceDiffPercentage
                  - type: label-element
                    label: Resource Configuration
                    subtitle: Define minimum and maximum allowed resources to ensure optimal database performance
                  - type: block-layout
                    showLabels: false
                    elements:
                      - type: machine-compare
                        label: Min Allowed Profile
                        header: Minimum Resource Limit
                        schema: temp/properties/allowedMachine-broker-min
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|broker|min
                        loader:
                          name: getMachines|broker|min
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-broker-max
                        watcher:
                          func: onMachineChange|broker
                          paths:
                            - temp/properties/allowedMachine-broker-min
                      - type: block-layout
                        label: Min Allowed
                        fixedBlock: true
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/minAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/minAllowed/properties/memory
                      - type: machine-compare
                        label: Max Allowed Profile
                        header: Maximum Resource Limit
                        schema: temp/properties/allowedMachine-broker-max
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|broker|max
                        loader:
                          name: getMachines|broker|max
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-broker-min
                        watcher:
                          func: onMachineChange|broker
                          paths:
                            - temp/properties/allowedMachine-broker-max
                      - type: block-layout
                        label: Max Allowed
                        fixedBlock: true
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/maxAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/maxAllowed/properties/memory
                  - type: select
                    label: Controlled Resources
                    loader: setControlledResources|compute/broker
                    multiple: true
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/controlledResources
                  - type: select
                    label: Container Controlled Values
                    options:
                      - text: Requests And Limits
                        value: RequestsAndLimits
                      - text: Requests Only
                        value: RequestsOnly
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/broker/properties/containerControlledValues

              # Controller section
              - type: switch
                label: Trigger
                fullwidth: true
                schema: temp/properties/compute/properties/controller/properties/trigger
                watcher:
                  func: onTriggerChange|compute/controller
                  paths:
                    - temp/properties/compute/properties/controller/properties/trigger
                init:
                  type: func
                  value: setTrigger|autoscalingKubedbComKafkaAutoscaler/spec/compute/controller/trigger
              - type: label-element
                label: Pod lifetime threshold
                subtitle: Specifies the duration a pod can exist before using considered for scaling decisions, ensuring resource optimization and workload stability
              - type: input
                label: Pod LifeTime Threshold (e.g., 10m 30s)
                customClass: width-300
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/podLifeTimeThreshold
              - type: block-layout
                label: Controller
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller
                elements:
                  - type: threshold-input
                    label: ResourceDiff Percentage
                    customClass: width-300
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/resourceDiffPercentage
                  - type: label-element
                    label: Resource Configuration
                    subtitle: Define minimum and maximum allowed resources to ensure optimal database performance
                  - type: block-layout
                    showLabels: false
                    elements:
                      - type: machine-compare
                        label: Min Allowed Profile
                        header: Minimum Resource Limit
                        schema: temp/properties/allowedMachine-controller-min
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|controller|min
                        loader:
                          name: getMachines|controller|min
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-controller-max
                        watcher:
                          func: onMachineChange|controller
                          paths:
                            - temp/properties/allowedMachine-controller-min
                      - type: block-layout
                        label: Min Allowed
                        fixedBlock: true
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/minAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/minAllowed/properties/memory
                      - type: machine-compare
                        label: Max Allowed Profile
                        header: Maximum Resource Limit
                        schema: temp/properties/allowedMachine-controller-max
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|controller|max
                        loader:
                          name: getMachines|controller|max
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-controller-min
                        watcher:
                          func: onMachineChange|controller
                          paths:
                            - temp/properties/allowedMachine-controller-max
                      - type: block-layout
                        label: Max Allowed
                        fixedBlock: true
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/maxAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/maxAllowed/properties/memory
                  - type: select
                    label: Controlled Resources
                    loader: setControlledResources|compute/controller
                    multiple: true
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/controlledResources
                  - type: select
                    label: Container Controlled Values
                    options:
                      - text: Requests And Limits
                        value: RequestsAndLimits
                      - text: Requests Only
                        value: RequestsOnly
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/controller/properties/containerControlledValues

          # combined mode - node only
          - type: block-layout
            label: Combined
            if:
              type: function
              name: dbTypeEqualsTo|combined
            showLabels: false
            # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute
            elements:
              # Node section
              - type: switch
                label: Trigger
                fullwidth: true
                schema: temp/properties/compute/properties/node/properties/trigger
                watcher:
                  func: onTriggerChange|compute/node
                  paths:
                    - temp/properties/compute/properties/node/properties/trigger
                init:
                  type: func
                  value: setTrigger|autoscalingKubedbComKafkaAutoscaler/spec/compute/node/trigger
              - type: label-element
                label: Pod lifetime threshold
                subtitle: Specifies the duration a pod can exist before using considered for scaling decisions, ensuring resource optimization and workload stability
              - type: input
                label: Pod LifeTime Threshold (e.g., 10m 30s)
                customClass: width-300
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/podLifeTimeThreshold
              - type: block-layout
                label: Node
                showLabels: true
                # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node
                elements:
                  - type: threshold-input
                    label: ResourceDiff Percentage
                    customClass: width-300
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/resourceDiffPercentage
                  - type: label-element
                    label: Resource Configuration
                    subtitle: Define minimum and maximum allowed resources to ensure optimal database performance
                  - type: block-layout
                    showLabels: false
                    elements:
                      - type: machine-compare
                        label: Min Allowed Profile
                        header: Minimum Resource Limit
                        schema: temp/properties/allowedMachine-node-min
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|node|min
                        loader:
                          name: getMachines|node|min
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-node-max
                        watcher:
                          func: onMachineChange|node
                          paths:
                            - temp/properties/allowedMachine-node-min
                      - type: block-layout
                        label: Min Allowed
                        fixedBlock: true
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/minAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/minAllowed/properties/memory
                      - type: machine-compare
                        label: Max Allowed Profile
                        header: Maximum Resource Limit
                        schema: temp/properties/allowedMachine-node-max
                        if:
                          type: function
                          name: hasAnnotations
                        init:
                          type: func
                          value: setAllowedMachine|node|max
                        loader:
                          name: getMachines|node|max
                          watchPaths:
                            - temp/properties/topologyMachines
                            - temp/properties/allowedMachine-node-min
                        watcher:
                          func: onMachineChange|node
                          paths:
                            - temp/properties/allowedMachine-node-max
                      - type: block-layout
                        label: Max Allowed
                        fixedBlock: true
                        if:
                          type: function
                          name: hasNoAnnotations
                        showLabels: true
                        elements:
                          - type: input-compare
                            label: Cpu
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/maxAllowed/properties/cpu
                          - type: input-compare
                            label: Memory
                            schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/maxAllowed/properties/memory
                  - type: select
                    label: Controlled Resources
                    loader: setControlledResources|compute/node
                    multiple: true
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/controlledResources
                  - type: select
                    label: Container Controlled Values
                    options:
                      - text: Requests And Limits
                        value: RequestsAndLimits
                      - text: Requests Only
                        value: RequestsOnly
                    schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/node/properties/containerControlledValues

          - type: block-layout
            label: Node Topology
            if:
              type: function
              name: hasNoAnnotations
            showLabels: true
            # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/nodeTopology
            elements:
              - type: select
                label: Select Node Topology
                loader: fetchNodeTopology
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/nodeTopology/properties/name
              - type: threshold-input
                label: ScaleUp Diff Percentage
                if:
                  type: function
                  name: isNodeTopologySelected
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/nodeTopology/properties/scaleUpDiffPercentage
              - type: threshold-input
                label: ScaleDown Diff Percentage
                if:
                  type: function
                  name: isNodeTopologySelected
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/compute/properties/nodeTopology/properties/scaleDownDiffPercentage

          - type: block-layout
            label: Ops Request Options
            showLabels: true
            if:
              type: function
              name: showOpsRequestOptions
            # schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/opsRequestOptions
            elements:
              - type: time-picker
                label: Timeout
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/opsRequestOptions/properties/timeout
              - type: radio
                label: Apply
                init:
                  type: func
                  value: setApplyToIfReady
                options:
                  - text: IfReady (OpsRequest will be applied if database is ready)
                    value: IfReady
                  - text: Always (OpsRequest will always be applied)
                    value: Always
                schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/opsRequestOptions/properties/apply

  - type: single-step-form
    id: storage-autoscaler
    loader: getDbDetails
    elements:
    - type: block-layout
      showLabels: false
      elements:
        - type: block-layout
          showLabels: true
          if:
            type: function
            name: isConsole
          elements:
            - type: input
              label: Name
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/metadata/properties/name
            - type: select
              label: SelectNamespace
              loader: getNamespaces
              hasGroup: isRancherManaged
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/metadata/properties/namespace
              watcher:
                func: onNamespaceChange
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/metadata/properties/namespace
            - type: select
              label: Select Db
              loader: getDbs
              refresh: true
              validation:
                type: required
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/databaseRef/properties/name
              watcher:
                func: initMetadata
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/databaseRef/properties/name
        - type: radio
          label: Select Type
          validation:
            type: required
          isHorizontal: true
          schema: discriminator/properties/autoscalingType
          options:
            - text: Compute
              value: compute
              description: Scale your CPU Memory based on resource usage
            - text: Storage
              value: storage
              description: Expand your database size based on volume usage
          if:
            type: function
            name: isConsole
          watcher:
            func: initMetadata
            paths:
              - discriminator/properties/autoscalingType
        # Broker mode
        - type: switch
          label: Trigger
          fullwidth: true
          if:
            type: function
            name: dbTypeEqualsTo|topology
          schema: temp/properties/storage/properties/broker/properties/trigger
          watcher:
            func: onTriggerChange|storage/broker
            paths:
              - temp/properties/storage/properties/broker/properties/trigger
          init:
            type: func
            value: setTrigger|autoscalingKubedbComKafkaAutoscaler/spec/storage/broker/trigger
        - type: label-element
          label: Expansion Mode (Online/Offline)
          subtitle: For Online Mode enables scaling without downtime by dynamically resizing storage while the database remains operational and Offline Mode performs storage scaling during scheduled downtime, ensuring consistency but requiring database restarts.
          if:
            type: function
            name: dbTypeEqualsTo|topology
        - type: select
          label: Mode
          description: Select how the storage expansion should be handled.
          if:
            type: function
            name: dbTypeEqualsTo|topology
          options:
            - text: Online
              value: Online
            - text: Offline
              value: Offline
          schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/expansionMode
        - type: block-layout
          label: Broker
          showLabels: true
          loader: getDbDetails
          if:
            type: function
            name: dbTypeEqualsTo|topology
          elements:
            - type: threshold-input
              label: UsageThreshold (%)
              subtitle: Set the storage usage percentage that triggers automatic expansion
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/usageThreshold
            - type: scaling-rules
              label: Scaling Rules
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/scalingRules
              loader: setValueFromDbDetails|resources/kubedbComKafka/spec/topology/broker/storage/resources/requests/storage
              watcher:
                func: handleUnit|autoscalingKubedbComKafkaAutoscaler/spec/storage/broker/scalingRules|scalingRules
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/scalingRules
            - type: input
              label: Scaling Threshold
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/scalingThreshold      
            - type: input
              label: UpperBound
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/upperBound
              watcher:
                func: handleUnit|autoscalingKubedbComKafkaAutoscaler/spec/storage/broker/upperBound
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/broker/properties/upperBound
        # Controller mode
        - type: switch
          label: Trigger
          fullwidth: true
          schema: temp/properties/storage/properties/controller/properties/trigger
          if:
            type: function
            name: dbTypeEqualsTo|topology
          watcher:
            func: onTriggerChange|storage/controller
            paths:
              - temp/properties/storage/properties/controller/properties/trigger
          init:
            type: func
            value: setTrigger|autoscalingKubedbComKafkaAutoscaler/spec/storage/controller/trigger
        - type: label-element
          label: Expansion Mode (Online/Offline)
          subtitle: For Online Mode enables scaling without downtime by dynamically resizing storage while the database remains operational and Offline Mode performs storage scaling during scheduled downtime, ensuring consistency but requiring database restarts.
          if:
            type: function
            name: dbTypeEqualsTo|topology
        - type: select
          label: Mode
          description: Select how the storage expansion should be handled.
          if:
            type: function
            name: dbTypeEqualsTo|topology
          options:
            - text: Online
              value: Online
            - text: Offline
              value: Offline
          schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/expansionMode
        - type: block-layout
          label: Controller
          showLabels: true
          loader: getDbDetails
          if:
            type: function
            name: dbTypeEqualsTo|topology
          elements:
            - type: threshold-input
              label: UsageThreshold (%)
              subtitle: Set the storage usage percentage that triggers automatic expansion
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/usageThreshold
            - type: input
              label: Scaling Threshold
              customClass: width-300
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/scalingThreshold
            - type: scaling-rules
              label: Scaling Rules
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/scalingRules
              loader: setValueFromDbDetails|resources/kubedbComKafka/spec/topology/controller/storage/resources/requests/storage
              watcher:
                func: handleUnit|autoscalingKubedbComKafkaAutoscaler/spec/storage/controller/scalingRules|scalingRules
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/scalingRules
            - type: input
              label: Scaling Threshold
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/scalingThreshold
            - type: input
              label: UpperBound
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/upperBound
              watcher:
                func: handleUnit|autoscalingKubedbComKafkaAutoscaler/spec/storage/controller/upperBound
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/controller/properties/upperBound
        # Node mode
        - type: switch
          label: Trigger
          fullwidth: true
          schema: temp/properties/storage/properties/node/properties/trigger
          if:
            type: function
            name: dbTypeEqualsTo|combined
          watcher:
            func: onTriggerChange|storage/node
            paths:
              - temp/properties/storage/properties/node/properties/trigger
          init:
            type: func
            value: setTrigger|autoscalingKubedbComKafkaAutoscaler/spec/storage/node/trigger
        - type: label-element
          label: Expansion Mode (Online/Offline)
          subtitle: For Online Mode enables scaling without downtime by dynamically resizing storage while the database remains operational and Offline Mode performs storage scaling during scheduled downtime, ensuring consistency but requiring database restarts.
          if:
            type: function
            name: dbTypeEqualsTo|combined
        - type: select
          label: Mode
          description: Select how the storage expansion should be handled.
          if:
            type: function
            name: dbTypeEqualsTo|combined
          options:
            - text: Online
              value: Online
            - text: Offline
              value: Offline
          schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/expansionMode
        - type: block-layout
          label: Node
          showLabels: true
          loader: getDbDetails
          if:
            type: function
            name: dbTypeEqualsTo|combined
          elements:
            - type: threshold-input
              label: Usage Threshold (%)
              subtitle: Set the storage usage percentage that triggers automatic expansion
              customClass: width-300
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/usageThreshold
            - type: input
              label: Scaling Threshold
              customClass: width-300
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingThreshold
            - type: scaling-rules
              label: Scaling Rules
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingRules
              loader: setValueFromDbDetails|resources/kubedbComKafka/spec/topology/node/storage/resources/requests/storage
              watcher:
                func: handleUnit|autoscalingKubedbComKafkaAutoscaler/spec/storage/node/scalingRules|scalingRules
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingRules
            - type: input
              label: Scaling Threshold
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/scalingThreshold
            - type: input
              label: UpperBound
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/upperBound
              watcher:
                func: handleUnit|autoscalingKubedbComKafkaAutoscaler/spec/storage/node/upperBound
                paths:
                  - schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/storage/properties/node/properties/upperBound
        # Ops Request Options
        - type: block-layout
          label: Ops Request Options
          showLabels: true
          if:
            type: function
            name: showOpsRequestOptions
          elements:
            - type: time-picker
              label: Timeout
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/opsRequestOptions/properties/timeout
            - type: radio
              label: Apply
              init:
                type: func
                value: setApplyToIfReady
              options:
                - text: IfReady (OpsRequest will be applied if database is ready)
                  value: IfReady
                - text: Always (OpsRequest will always be applied)
                  value: Always
              schema: schema/properties/resources/properties/autoscalingKubedbComKafkaAutoscaler/properties/spec/properties/opsRequestOptions/properties/apply

  - type: single-step-form
    id: monitoring
    elements:
    - type: label-element
      label: To update Exporter Resource section click on Create OpsRequest
    - type: anchor
      label: Create OpsRequest
      schema: temp/properties/opsRequestUrl
      init:
        type: func
        value: getOpsRequestUrl|VerticalScaling
    - type: switch
      label: Enable Monitoring
      fullwidth: true
      schema: temp/properties/enableMonitoring
      init:
        type: func
        value: isValueExistInModel|/resources/kubedbComKafka/spec/monitor
      watcher:
        func: onEnableMonitoringChange
        paths:
          - temp/properties/enableMonitoring
    - type: block-layout
      label: Backup form 
      showLabels: false
      if:
        type: function
        name: showMonitoringSection
      elements:
        - type: radio
          label: Select a Monitoring Method
          schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/agent
          isHorizontal: true
          options:
          - text: Prometheus Operator
            value: prometheus.io/operator
            description: Inject metric exporter sidecar and creates a ServiceMonitor
          - text: Custom ServiceMonitor
            value: prometheus.io
            description: Injects the metric exporter sidecar and let you customize ServiceMonitor
          - text: Custom Scrapper
            value: prometheus.io/builtin
            description: Inject metric exporter sidecar and add Prometheus annotations to the stats Service
          init:
            type: static
            value: prometheus.io/operator
          watcher:
            func: onAgentChange
            paths:
              - schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/agent
        - type: block-layout
          label: ServiceMonitor Configuration  
          showLabels: true 
          if: 
            type: function
            name: isEqualToModelPathValue|prometheus.io/operator|/resources/kubedbComKafka/spec/monitor/agent
          elements:
            - label: Scrapping Interval
              schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/serviceMonitor/properties/interval
              type: input 
        - type: block-layout
          label: Service Monitor
          showLabels: true
          if:
            type: function
            name: isEqualToModelPathValue|prometheus.io|/resources/kubedbComKafka/spec/monitor/agent
          elements:
          - type: array-object-form
            label: Endpoints
            buttonClass: is-light is-outlined
            schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/endpoints
            elements:
            - type: switch
              label: Honor labels
              fullwidth: true
              schema: honorLabels
            - type: input
              label: Interval
              schema: interval
            - type: input
              label: Path
              schema: path
            - type: input
              label: Port
              schema: port
          - type: select
            multiple: true
            label: Match Namespaces
            schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/namespaceSelector/properties/matchNames
            loader: getResources|core|v1|namespaces
            if: 
              type: function
              name: returnFalse
          - type: block-layout
            showLabels: false
            # schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/selector
            if: 
              type: function
              name: returnFalse
            elements:
              - type: object-item
                label: Labels
                buttonClass: is-light is-outlined
                schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/spec/properties/selector/properties/matchLabels
        - type: object-item
          schema: schema/properties/resources/properties/monitoringCoreosComServiceMonitor/properties/metadata/properties/labels
          label : Labels
          buttonClass: is-light is-outlined
          if:
            type: function
            name: isEqualToModelPathValue|prometheus.io|/resources/kubedbComKafka/spec/monitor/agent
          # individualItemDisabilityCheck: disableLableChecker
        - type: label-element
          label: Exporter Configuration
          schema: ''
        - type: switch
          label: Customize Exporter Sidecar
          fullwidth: true
          schema: temp/properties/customizeExporter
          init:
            type: static
            value: true
          watcher:
            func: onCustomizeExporterChange
            paths:
              - temp/properties/customizeExporter
        - type: block-layout
          label: Customer Exporter Section 
          showLabels: false
          if:
            type: function
            name: showCustomizeExporterSection
          elements:
            - type: machine-compare
              label: Resources
              schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/resources
              if: 
                type: function
                name: returnFalse
            - type: label-element
              label: Security Context
              schema: ''
            - type: input
              schema:  schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/securityContext/properties/runAsUser
              label: Run as User
            - type: input
              schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/securityContext/properties/runAsGroup
              label: Run as Group
            - type: input
              schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/port
              label: Port
            - type: array-item-form
              label: Args
              buttonClass: is-light is-outlined
              schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/args
              init:
                type: static
                value: ['--compatible-mode']
              element:
                type: input
                label: Args
                # isSubsection: true
            - type: block-layout
              label: Metadata
              showLabels: false
              elements: 
                  #remove: should be array-object-form after fixes
                - type: block-layout
                  label: New Environment Variable
                  showLabels: true
                  hideBlock: true
                  # schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env
                  elements:
                  - type: input
                    label: Name
                    schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/name
                  - type: radio
                    label: Value From
                    schema: temp/properties/valueFromType
                    init: 
                      type: func 
                      value: setValueFrom
                    options:
                    - text: Input
                      value: input
                    - text: Secret
                      value: secret
                    - text: ConfigMap
                      value: configMap
                    watcher:
                      func: onValueFromChange
                      paths:
                        - temp/properties/valueFromType
                  - type: input 
                    label: Value 
                    schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/value
                    if:
                      name: isEqualToValueFromType|input
                      type: function
                  - type: select
                    if:
                      type: function
                      name: isEqualToValueFromType|configMap
                    label: ConfigMap Name
                    schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/configMapKeyRef/properties/name
                    loader:
                      name: resourceNames|core|v1|configmaps
                      watchPaths:
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true
                  - type: select
                    label: ConfigMap Key
                    schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/configMapKeyRef/properties/key
                    if:
                      type: function
                      name: isEqualToValueFromType|configMap
                    loader:
                      name: getConfigMapKeys
                      watchPaths:
                        - schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/valueFrom/configMapKeyRef/name
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true
                  - type: select
                    label: Secret Name
                    schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/secretKeyRef/properties/name
                    if:
                      type: function
                      name: isEqualToValueFromType|secret
                    loader:
                      name: getSecrets
                      watchPaths:
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true
                  - type: select
                    label: Secret Key
                    schema: schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/properties/valueFrom/properties/secretKeyRef/properties/key
                    if:
                      type: function
                      name: isEqualToValueFromType|secret
                    loader:
                      name: getSecretKeys
                      watchPaths:
                        - schema/properties/resources/properties/kubedbComKafka/properties/spec/properties/monitor/properties/prometheus/properties/exporter/properties/env/properties/items/valueFrom/secretKeyRef/name
                        - schema/metadata/release/namespace
                    # allowUserDefinedOption: true

  - type: single-step-form
    id: binding
    elements:
    - type: switch
      label: Expose Database
      schema: temp/properties/binding
      fullwidth: true
      init:
        type: func
        value: isBindingAlreadyOn
      watcher:
        func: addOrRemoveBinding
        paths:
          - temp/properties/binding