{{- if .Values.spec.storageSecret.create -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "storagekubestashcom-backupstorage-editor-options.fullname" . }}-storage-cred
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "storagekubestashcom-backupstorage-editor-options.labels" . | nindent 4 }}
type: Opaque
stringData:

{{- if eq .Values.spec.backend.provider "s3" }}
  {{- with .Values.spec.backend.s3.auth }}
  AWS_ACCESS_KEY_ID: '{{ .AWS_ACCESS_KEY_ID }}'
  AWS_SECRET_ACCESS_KEY: '{{ .AWS_SECRET_ACCESS_KEY }}'
  {{- with .CA_CERT_DATA }}
  CA_CERT_DATA: '{{ . }}'
  {{- end }}
  {{- end }}
{{- end }}

{{- if eq .Values.spec.backend.provider "azure" }}
  {{- with .Values.spec.backend.azure.auth }}
  AZURE_ACCOUNT_KEY: '{{ .AZURE_ACCOUNT_KEY }}'
  {{- end }}
{{- end }}

{{- if eq .Values.spec.backend.provider "gcs" }}
  {{- with .Values.spec.backend.gcs.auth }}
  GOOGLE_SERVICE_ACCOUNT_JSON_KEY: '{{ .GOOGLE_SERVICE_ACCOUNT_JSON_KEY }}'
  {{- with .GOOGLE_PROJECT_ID }}
  GOOGLE_PROJECT_ID: '{{ . }}'
  {{- end }}
  {{- end }}
{{- end }}
{{- end }}
