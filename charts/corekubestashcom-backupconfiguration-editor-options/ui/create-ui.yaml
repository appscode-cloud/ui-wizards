steps:
- form:
    discriminator:
      nameSpaceApi:
        type: boolean
        default: false
    elements:
    - type: input
      computed: init
      if: returnFalse
    - type: single-step-form
      label:
        text: Storage Ref
      show_label: true
      elements:
      - type: select
        schema:
          $ref: schema#/properties/spec/properties/backend/properties/storageRef/properties/namespace
        fetch: getNamespaces
        label:
          text: Namespace
      - type: select
        schema:
          $ref: schema#/properties/spec/properties/backend/properties/storageRef/properties/name
        fetch: getNames|storageRef
        label:
          text: name
    - type: single-step-form
      label:
        text: Retention Policy
      show_label: true
      elements:
      - type: select
        schema:
          $ref: schema#/properties/spec/properties/backend/properties/retentionPolicy/properties/namespace
        fetch: getNamespaces
        label:
          text: Namespace
      - type: select
        schema:
          $ref: schema#/properties/spec/properties/backend/properties/retentionPolicy/properties/name
        fetch: getNames|retentionPolicy
        label:
          text: name
    - type: single-step-form
      elements:
      - isArray: true
        keys:
          label:
            text: labels.labels.key
        label:
          text: labels.labels.label
        schema:
          $ref: schema#/properties/spec/properties/labels
        type: key-value-input-form
        values:
          label:
            text: labels.labels.value
          schema:
            $ref: schema#/properties/spec/properties/labels/additionalProperties
          type: input
      - isArray: true
        keys:
          label:
            text: labels.annotations.key
        label:
          text: labels.annotations.label
        schema:
          $ref: schema#/properties/spec/properties/annotations
        type: key-value-input-form
        values:
          label:
            text: labels.annotations.value
          schema:
            $ref: schema#/properties/spec/properties/annotations/additionalProperties
          type: input
      hideForm: true
      label:
        text: Labels & Annotations
      show_label: true
    - type: single-step-form 
      elements:
      - addFormLabel: Session
        element:
          elements:
          - type: input
            label:
              text: Session Name
            schema:
              $ref: schema#/properties/spec/properties/session/items/properties/sessionName
          - type: input
            label:
              text: Schedule
            schema:
              $ref: schema#/properties/spec/properties/session/items/properties/schedule
          - type: single-step-form
            show_label: true
            label:
              text: Addon
            schema:
              $ref: schema#/properties/spec/properties/session/items/properties/addon
            elements:
            - label:
                text: Security Context
              schema:
                $ref: schema#/properties/spec/properties/session/items/properties/addon/properties/jobTemplate/properties/securityContext
              type: input
            - label:
                text: Name
              schema:
                $ref: schema#/properties/spec/properties/session/items/properties/addon/properties/name
              fetch: getAddon
              type: select
            - addFormLabel: Task
              element:
                elements:
                - label:
                    text: Name
                  schema:
                    $ref: schema#/properties/spec/properties/session/items/properties/addon/properties/tasks/items/properties/name
                  fetch: getTaskNames
                  type: select
                - label:
                    text: Params
                  schema:
                    $ref: schema#/properties/spec/properties/session/items/properties/addon/properties/tasks/items/properties/params
                  type: editor
                type: single-step-form
              tableContents:
              - inTableColumn: true
                label:
                  text: Name
                path: name
                type: value
                typeOfValue: string
              - inTableColumn: true
                label:
                  text: Params
                path: params
                type: value
                typeOfValue: string
              label:
                text: Tasks
              schema:
                $ref: schema#/properties/spec/properties/session/items/properties/addon/properties/tasks
              type: single-step-form-array
          - type: single-step-form
            label:
              text: encryptionSecret
            show_label: true
            schema:
              $ref: schema#/properties/spec/properties/session/items/properties/encryptionSecret
            elements:
            - label:
                text: Namespace
              fetch: getNamespaces
              schema:
                $ref: schema#/properties/spec/properties/session/items/properties/encryptionSecret/properties/namespace
              type: select
            - label:
                text: Name
              fetch: getEncryptionSecretNames
              schema:
                $ref: schema#/properties/spec/properties/session/items/properties/encryptionSecret/properties/name
              type: select
          - type: input
            label:
              text: Repo Name
            schema:
              $ref: schema#/properties/spec/properties/session/items/properties/repoName
          type: single-step-form
        label:
          text: Session
        schema:
          $ref: schema#/properties/spec/properties/session
        tableContents:
        - inTableColumn: true
          label:
            text: Repo Name
          path: repoName
          type: value
          typeOfValue: string
        - inTableColumn: true
          label:
            text: Schedule
          path: schedule
          type: value
          typeOfValue: string
        - inTableColumn: true
          label:
            text: Session Name
          path: sessionName
          type: value
          typeOfValue: string
        type: single-step-form-array
    - type: single-step-form
      label:
        text: Target
      show_label: true
      elements:
      - type: select
        fetch: getApiGroup
        schema:
          $ref: schema#/properties/spec/properties/target/properties/apiGroup
        label:
          text: Api Group
      - type: select
        schema:
          $ref: schema#/properties/spec/properties/target/properties/kind
        fetch: getKinds
        label:
          text: Kind
      - type: select
        schema:
          $ref: schema#/properties/spec/properties/target/properties/namespace
        fetch: getNamespaces
        label:
          text: Namespace
      - type: select
        fetch: getTargetName
        schema:
          $ref: schema#/properties/spec/properties/target/properties/name
        label:
          text: Name 
    type: single-step-form
  id: options
  title: steps.0.label
type: multi-step-form
