step:
- elements:
  - loader: initBundle
    label: ""
    schema: ""
    if: 
      name: returnFalse
      type: function
    type: input
  - loader: getAdminOptions|databases/MongoDB/versions
    if: 
      type: function
      name: isToggleOn|databases/MongoDB/versions
    label: Database Version
    schema: schema/properties/spec/properties/admin/properties/databases/properties/MongoDB/properties/versions/properties/default
    type: select
  - init:
      type: func
      value: getDefault|databases/MongoDB/mode
    loader: getAdminOptions|databases/MongoDB/mode
    # hasDescription: true
    if:
      name: isToggleOn|databases/MongoDB/mode
      type: function
    label: Database Mode
    options: []
    # onChange: clearArbiterHidden
    schema: schema/properties/spec/properties/mode
    type: radio
  - elements:
    - label: Replicaset Name
      schema: schema/properties/spec/properties/replicaSet/properties/name
      type: input
    - label: Replica Number
      # onChange: updateSuffix
      schema: schema/properties/spec/properties/replicaSet/properties/replicas
      type: input
    - if:
        type: function
        name: isTlsOn
      label: Do you want to access mongodb+srv style dns?
      # onChange: onHorizonsChange
      schema: tepm/enableHorizons
      type: switch
    # - alertInfo:
    #     show: true
    #     type: neutral
    #   if: isHorizonsOn
    #   label:
    #     text: Horizons count should be equal to Replica Number.
    #   type: label-element
    - element:
        label: Add a new horizon dns for pod
        schema: schema/properties/spec/properties/replicaSet/properties/horizons/items
        type: input
      if:
        type: function
        name: isHorizonsOn
      label: Horizons
      # onChange: updateSuffix
      schema: schema/properties/spec/properties/replicaSet/properties/horizons
      type: array-item-form
    if:
      type: function
      name: isEqualToModelPathValue|Replicaset|/spec/mode
    label: Replicaset
    type: block-layout
  - elements:
    - elements:
      - label: Number of Shards
        schema: schema/properties/spec/properties/shardTopology/properties/shard/properties/shards
        type: input
      - label: Replica Number
        schema: schema/properties/spec/properties/shardTopology/properties/shard/properties/replicas
        type: input
      - label:
          text: labels.storage.size
        schema:
          $ref: schema/properties/spec/properties/shardTopology/properties/shard/properties/persistence/properties/size
        type: input
      - elements:
        - init:
            type: func
            value: setMachineToCustom|shardTopology/shard
          loader: getMachineListForOptions
          label: Machine
          schema: schema/properties/spec/properties/shardTopology/properties/shard/properties/podResources/properties/machine
          type: select
        - init:
            type: func
            value: setLimits|cpu|shardTopology/shard
          disable: isMachineNotCustom|shardTopology/shard
          if:
            type: function
            name: isMachineCustom|shardTopology/shard
          label: CPU
          # onChange: setRequests|cpu|shardTopology/shard
          schema: schema/properties/spec/properties/shardTopology/properties/shard/properties/podResources/properties/resources/properties/requests/properties/cpu
          type: input
        - init:
            type: func
            value: setLimits|memory|shardTopology/shard
          disable: isMachineNotCustom|shardTopology/shard
          if:
            type: function
            name: isMachineCustom|shardTopology/shard
          label: Memory
          # onChange: setRequests|memory|shardTopology/shard
          schema: schema/properties/spec/properties/shardTopology/properties/shard/properties/podResources/properties/resources/properties/requests/properties/memory
          type: input
        label: Shard
        type: block-layout
      label: Shard Nodes
      showLabels: true
      type: block-layout
    - elements:
      - label: Replica Number
        schema: schema/properties/spec/properties/shardTopology/properties/configServer/properties/replicas
        type: input
      - label: Storage Size
        schema: schema/properties/spec/properties/shardTopology/properties/configServer/properties/persistence/properties/size
        type: input
      - elements:
        - init:
            type: func
            value: setMachineToCustom|shardTopology/configServer
          loader: getMachineListForOptions
          label: Machine
          schema: schema/properties/spec/properties/shardTopology/properties/configServer/properties/podResources/properties/machine
          type: select
        - init:
            type: func
            value: setLimits|cpu|shardTopology/configServer
          disable: isMachineNotCustom|shardTopology/configServer
          if:
            type: function
            name: isMachineCustom|shardTopology/configServer
          label: CPU
          # onChange: setRequests|cpu|shardTopology/configServer
          schema: schema/properties/spec/properties/shardTopology/properties/configServer/properties/podResources/properties/resources/properties/requests/properties/cpu
          type: input
        - init:
            type: func
            value: setLimits|memory|shardTopology/configServer
          disable: isMachineNotCustom|shardTopology/configServer
          if:
            type: function
            name: isMachineCustom|shardTopology/configServer
          label: Memory
          # onChange: setRequests|memory|shardTopology/configServer
          schema: schema/properties/spec/properties/shardTopology/properties/configServer/properties/podResources/properties/resources/properties/requests/properties/memory
          type: input
        label: Config Server
        type: block-layout
      label: Config Server
      type: block-layout
    - elements:
      - label: Replica Number
        schema: schema/properties/spec/properties/shardTopology/properties/mongos/properties/replicas
        type: input
      - elements:
        - init:
            type: func
            value: setMachineToCustom|shardTopology/mongos
          loader: getMachineListForOptions
          label: Machine
          schema: schema/properties/spec/properties/shardTopology/properties/mongos/properties/podResources/properties/machine
          type: select
        - init:
            type: func
            value: setLimits|cpu|shardTopology/mongos
          disable: isMachineNotCustom|shardTopology/mongos
          if:
            type: function
            name: isMachineCustom|shardTopology/mongos
          label: CPU
          # onChange: setRequests|cpu|shardTopology/mongos
          schema: schema/properties/spec/properties/shardTopology/properties/mongos/properties/podResources/properties/resources/properties/requests/properties/cpu
          type: input
        - init:
            type: func
            value: setLimits|memory|shardTopology/mongos
          disable: isMachineNotCustom|shardTopology/mongos
          if:
            type: function
            name: isMachineCustom|shardTopology/mongos
          label: Memory
          # onChange: setRequests|memory|shardTopology/mongos
          schema: schema/properties/spec/properties/shardTopology/properties/mongos/properties/podResources/properties/resources/properties/requests/properties/memory
          type: input
        label: Mongos
        type: block-layout
      label: Mongos
      type: block-layout
    label: Sharded
    if:
      type: function
      name: isEqualToModelPathValue|Sharded|/spec/mode
    type: block-layout
  - elements:
    - init:
        type: func
        value: setMachineToCustom
      loader: getMachineListForOptions
      label: Machine
      schema: schema/properties/spec/properties/podResources/properties/machine
      type: select
    - init:
        type: func
        value: setLimits|cpu
      disable: isMachineNotCustom
      if:
        type: function
        name: isMachineCustom
      label: CPU
      # onChange: setRequests|cpu
      schema: schema/properties/spec/properties/podResources/properties/resources/properties/requests/properties/cpu
      type: input
    - init:
        type: func
        value: setLimits|memory
      disable: isMachineNotCustom
      if:
        type: function
        name: isMachineCustom
      label: Memory
      # onChange: setRequests|memory
      schema: schema/properties/spec/properties/podResources/properties/resources/properties/requests/properties/memory
      type: input
    if:
      type: function
      name: notEqualToDatabaseMode|Sharded
    label: Machine Profile
    type: block-layout
  - loader: getAdminOptions|storageClasses
    if:
      type: function
      name: isToggleOn|storageClasses
    label: Storage Class
    schema: schema/properties/spec/properties/admin/properties/storageClasses/properties/default
    type: select
  - if:
      type: function
      name: showStorageSizeField
    label: labels.storage.size
    schema: schema/properties/spec/properties/persistence/properties/size
    type: input
  - description: Configure Credentials, Deployment Mode etc.
    discriminator:
      configDatabase:
        default: false
        type: boolean
      createAuthSecret:
        default: false
        type: boolean
      recovery:
        default: false
        type: boolean
      referSecret:
        default: false
        type: boolean
    elements:
    - elements:
      - label: Label
        schema: schema/properties/spec/properties/labels
        type: object-item
      - label: Annotations
        schema: schema/properties/spec/properties/annotations
        type: object-item
      hideBlock: true
      label: Labels & Annotations
      type: block-layout
    - init:
        type: func
        value: getDefault|deletionPolicy
      # customClass: mt-20
      if:
        type: function
        name: isToggleOn|deletionPolicy
      label: labels.deletionPolicy
      # onChange: setStorageClass
      options:
      - Delete
      - Halt
      - WipeOut
      - DoNotTerminate
      schema: schema/properties/spec/properties/deletionPolicy
      type: select
    - if: getDefaultValue|spec/admin/authCredential/customize
      label:
        text: Provide Authentication Credentials?
      onChange: onAuthChange
      schema:
        $ref: discriminator#/createAuthSecret
      type: switch
    - if: showReferSecretSwitch
      label:
        text: Refer existing Secret?
      onChange: onReferSecretChange
      schema:
        $ref: discriminator#/referSecret
      type: switch
    - fetch: getReferSecrets
      if: showSecretDropdown
      label:
        text: Secret
      schema:
        $ref: schema/properties/spec/properties/authSecret/properties/name
      type: select
    - if: showReferSecret
      label:
        text: labels.password
      schema:
        $ref: schema/properties/spec/properties/authSecret/properties/password
      type: input
    - computed: isConfigAvailable
      if: getDefaultValue|spec/admin/customConfiguration
      label:
        text: Configure Database?
      onChange: clearConfiguration
      schema:
        $ref: discriminator#/configDatabase
      type: switch
    - if: isConfigDatabaseOn
      label:
        text: Configuration
      schema:
        $ref: schema/properties/spec/properties/configuration
      type: editor
    - if: notEqualToDatabaseMode|Standalone
      label:
        text: Enable Arbiter?
      schema:
        $ref: schema/properties/spec/properties/arbiter/properties/enabled
      type: switch
    - elements:
      - elements:
        - computed: setMachineToCustom|arbiter
          customClass: mt-10
          fetch: getMachineListForOptions
          label:
            text: labels.machine
          schema:
            $ref: schema/properties/spec/properties/arbiter/properties/podResources/properties/machine
          type: select
        - computed: setLimits|cpu|arbiter
          disabled: isMachineNotCustom|arbiter
          if: isMachineCustom|arbiter
          label:
            text: labels.cpu
          onChange: setRequests|cpu|arbiter
          schema:
            $ref: schema/properties/spec/properties/arbiter/properties/podResources/properties/resources/properties/requests/properties/cpu
          type: input
        - computed: setLimits|memory|arbiter
          disabled: isMachineNotCustom|arbiter
          if: isMachineCustom|arbiter
          label:
            text: labels.memory
          onChange: setRequests|memory|arbiter
          schema:
            $ref: schema/properties/spec/properties/arbiter/properties/podResources/properties/resources/properties/requests/properties/memory
          type: input
        schema:
          $ref: schema/properties/spec/properties/arbiter/properties/podResources
        type: single-step-form
      if: showArbiter
      label:
        text: Arbiter
      schema:
        $ref: schema/properties/spec/properties/arbiter
      show_label: true
      type: single-step-form
    - if: notEqualToDatabaseMode|Standalone
      label:
        text: Enable hidden?
      schema:
        $ref: schema/properties/spec/properties/hidden/properties/enabled
      type: switch
    - elements:
      - customClass: mt-10
        label:
          text: Replicas
        schema:
          $ref: schema/properties/spec/properties/hidden/properties/replicas
        type: input
      - label:
          text: Persistence Size
        schema:
          $ref: schema/properties/spec/properties/hidden/properties/persistence/properties/size
        type: input
      - computed: setMachineToCustom|hidden
        fetch: getMachineListForOptions
        label:
          text: labels.machine
        schema:
          $ref: schema/properties/spec/properties/hidden/properties/podResources/properties/machine
        type: select
      - computed: setLimits|cpu|hidden
        disabled: isMachineNotCustom|hidden
        if: isMachineCustom|hidden
        label:
          text: labels.cpu
        onChange: setRequests|cpu|hidden
        schema:
          $ref: schema/properties/spec/properties/hidden/properties/podResources/properties/resources/properties/requests/properties/cpu
        type: input
      - computed: setLimits|memory|hidden
        disabled: isMachineNotCustom|hidden
        if: isMachineCustom|hidden
        label:
          text: labels.memory
        schema:
          $ref: schema/properties/spec/properties/hidden/properties/podResources/properties/resources/properties/requests/properties/memory
        type: input
      if: showHidden
      label:
        text: Hidden
      schema:
        $ref: schema/properties/spec/properties/hidden/properties/podResources
      show_label: true
      type: single-step-form
    - computed: getDefault|pointInTimeRecovery
      if: isToggleOn|pointInTimeRecovery
      label:
        text: Point in-time Recovery?
      schema:
        $ref: discriminator#/recovery
      type: switch
    - discriminator:
        refDBName:
          type: string
        refNamespace:
          type: string
      elements:
      - label:
          text: Namespace
        onChange: setPointInTimeRecovery
        required: true
        schema:
          $ref: discriminator#/refNamespace
        type: input
      - label:
          text: Name
        onChange: setPointInTimeRecovery
        required: true
        schema:
          $ref: discriminator#/refDBName
        type: input
      - customClass: mt-10
        label:
          text: Recovery Timestamp
        schema:
          $ref: schema/properties/spec/properties/init/properties/archiver/properties/recoveryTimestamp
        type: input
      if: showRecovery
      label:
        text: Point in-time Recovery
      schema:
        $ref: schema/properties/spec/properties/init/properties/archiver
      show_label: true
      type: single-step-form
    - hasDescription: true
      if: isToggleOn|deployment
      label:
        text: labels.deployment.name
      options:
      - description: labels.deployment.shared
        text: Shared
        value: Shared
      - description: labels.deployment.dedicated
        text: Dedicated
        value: Dedicated
      schema:
        $ref: schema/properties/spec/properties/admin/properties/deployment/properties/default
      type: radio
    - if: isToggleOn|clusterTier
      isHorizontal: true
      label:
        text: labels.clusterTier
      options:
      - text: General Purpose
        value: GeneralPurpose
      - text: Memory Optimized
        value: MemoryOptimized
      - text: CPU Optimized
        value: CPUOptimized
      schema:
        $ref: schema/properties/spec/properties/admin/properties/clusterTier/properties/default
      type: radio
    - disableUnselect: true
      fetch: getAdminOptions|clusterTier/placement
      if: isToggleOn|clusterTier/placement
      label:
        text: labels.placement
      schema:
        $ref: schema/properties/spec/properties/admin/properties/clusterTier/properties/placement/properties/default
      type: select
    - disableUnselect: true
      fetch: getNodeTopology
      if: isToggleOn|clusterTier/nodeTopology
      label:
        text: labels.nodeTopology
      schema:
        $ref: schema/properties/spec/properties/admin/properties/clusterTier/properties/nodeTopology/properties/default
      type: select
    hideBlock: true
    label: Advanced Configuration
    type: block-layout
  - accordion: true
      description:
        text: Enable Backup, Monitoring, TLS etc.
      discriminator:
        backup:
          default: false
          type: boolean
      elements:
      - discriminator:
          monitoring:
            default: false
            type: boolean
        elements:
        - computed: setMonitoring
          label:
            text: labels.enable_monitoring
          onChange: updateAlertValue
          schema:
            $ref: discriminator#/monitoring
          type: switch
        - customClass: mt-10
          if: showAlerts
          label:
            text: labels.alert.options
          options:
          - text: None
            value: none
          - text: Critical
            value: critical
          - text: Warning
            value: warning
          - text: Info
            value: info
          schema:
            $ref: schema/properties/form/properties/alert/properties/enabled
          sortable: true
          type: select
        if: isToggleOn|monitoring
        type: single-step-form
      - computed: setBackup
        if: isToggleOn|backup
        label:
          text: Enable Backup?
        onChange: onBackupSwitch
        schema:
          $ref: discriminator#/backup
        type: switch
      - elements:
        - disabled: showArchiverAlert
          label:
            text: Enable Archiver?
          onChange: onArchiverChange
          schema:
            $ref: schema/properties/spec/properties/admin/properties/archiver/properties/enable/properties/default
          type: switch
        - alertInfo:
            show: true
            type: neutral
          if: showArchiverAlert
          label:
            text: The selected StorageClass does not support Archiver
          type: label-element
        if: showArchiver
        type: single-step-form
      - elements:
        - computed: checkHostnameOrIP
          if: isToggleOn|tls
          label:
            text: Enable TLS?
          onChange: checkHostnameOrIP
          schema:
            $ref: schema/properties/spec/properties/admin/properties/tls/properties/default
          type: switch
        - fetch: getAdminOptions|clusterIssuers
          if: showIssuer
          label:
            text: labels.clusterIssuers
          required: true
          schema:
            $ref: schema/properties/spec/properties/admin/properties/clusterIssuers/properties/default
          type: select
        type: single-step-form
      - elements:
        - computed: checkHostnameOrIP
          if: isToggleOn|expose
          label:
            text: Expose via Gateway?
          onChange: checkHostnameOrIP
          schema:
            $ref: schema/properties/spec/properties/admin/properties/expose/properties/default
          type: switch
        type: single-step-form
      if: showAdditionalSettings
      label:
        text: Additional Options
      show_label: true
      type: single-step-form
  type: single-step-from
  label: options
type: multi-step-form
