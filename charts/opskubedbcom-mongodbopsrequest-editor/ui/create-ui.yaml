type: multi-step-form
step:
  - type: single-step-form
    loader: getDbDetails
    elements:
# common
      - type: input
        label: op_req_name
        if:
          type: function
          name: showAndInitName        
        validation:
          type: required
        schema: schema/properties/metadata/properties/name
      - type: select
        label: Namespace
        if:
          type: function
          name: showAndInitNamespace
        init:
          type: func
          value: initNamespace
        disable: isNamespaceDisabled
        loader: getNamespaces
        validation:
          type: required
        hasGroup: isRancherManaged
        schema: schema/properties/metadata/properties/namespace
        watcher:
          func: onNamespaceChange
          paths:
            - schema/properties/metadata/properties/namespace
      - type: select
        label: Database Ref
        if:
          type: function
          name: showAndInitDatabaseRef
        loader:
          name: getDbs
          watchPaths:
            - schema/properties/metadata/properties/namespace
        init:
          type: func
          value: initDatabaseRef
        validation:
          type: required
        disable: isDatabaseRefDisabled
        refresh: true
        watcher:
          paths:
            - schema/properties/spec/properties/databaseRef/properties/name
          func: onDbChange
        schema: schema/properties/spec/properties/databaseRef/properties/name
      - type: label-element
        label: config_ops_request
        if:
          type: function
          name: showConfigureOpsrequestLabel
      - type: radio
        label: Type of Ops Request
        if:
          type: function
          name: showAndInitOpsRequestType
        options:
          - description: Update your database to any version
            text: Update Version
            value: UpdateVersion
          - description: Scale up or down pod count
            text: Horizontal Scaling
            value: HorizontalScaling
          - description: Manage your CPU resources
            text: Vertical Scaling
            value: VerticalScaling
          - description: Manage your database size
            text: Volume Expansion
            value: VolumeExpansion
          - description: Restart your database
            text: Restart
            value: Restart
          - description: Reconfigure your database
            text: Reconfigure
            value: Reconfigure
          - description: Reconfigure your database tls configuration
            text: Reconfigure TLS
            value: ReconfigureTLS
        init:
          type: func
          value: getRequestTypeFromRoute
        disable: isDbDetailsLoading
        watcher:
          func: onRequestTypeChange
          paths:
            - schema/properties/spec/properties/type
        isHorizontal: true
        schema: schema/properties/spec/properties/type
# UpdateVersion
      - type: block-layout
        showLabels: false
        if:
          type: function
          name: ifRequestTypeEqualsTo|UpdateVersion
        elements:
          - type: select-compare
            label: Target Version
            header: Version
            init:
              type: func
              value: setValueFromDbDetails|/spec/version
            loader: getDbVersions
            schema: schema/properties/spec/properties/updateVersion/properties/targetVersion
# Horizontal Scale
      - type: block-layout
        label: Horizontal Scaling Form
        if:
          type: function
          name: ifRequestTypeEqualsTo|HorizontalScaling
        elements:
          - type: horizontal-layout
            elements:
              - type: input-compare
                label: Replicas
                header: Replica
                subtitle: Define the total number of replicas for the database. Increasing replicas improves fault tolerance and load distribution , while reducing replicas conserves resources
                if:
                  type: function
                  name: ifDbTypeEqualsTo|replicaSet|horizontalScaling
                init:
                  type: func
                  value: setValueFromDbDetails|/spec/replicas
                schema: schema/properties/spec/properties/horizontalScaling/properties/replicas
              - type: info
                hasIcon: true
                label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability. 
                if:
                  type: function
                  name: ifDbTypeEqualsTo|replicaSet|horizontalScaling
          - type: block-layout
            label: 'Sharded horizontal scaling'
            if:
              name: ifDbTypeEqualsTo|sharded|horizontalScaling
              type: function
            elements:
              - type: block-layout
                label: Config Server horizontal Scaling
                showLabels: false
                elements:
                  - type: label-element
                    label: Config Server
                  - type: horizontal-layout
                    elements:
                      - type: input-compare
                        label: Replicas
                        subtitle: Define the total number of replicas for the database. Increasing replicas improves fault tolerance and load distribution , while reducing replicas conserves resources
                        schema: schema/properties/spec/properties/horizontalScaling/properties/configServer/properties/replicas
                        init:
                          type: func
                          value: setValueFromDbDetails|/spec/shardTopology/configServer/replicas
                      - type: info
                        hasIcon: true
                        label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability. 
              - type: block-layout
                label: Mongo Horizontal Scaling
                elements:
                  - type: label-element
                    label: Mongos
                  - type: horizontal-layout
                    elements:
                      - type: input-compare
                        label: Replicas
                        subtitle: Define the total number of replicas for the database. Increasing replicas improves fault tolerance and load distribution , while reducing replicas conserves resources
                        init:
                          type: func
                          value: setValueFromDbDetails|/spec/shardTopology/mongos/replicas
                        schema: schema/properties/spec/properties/horizontalScaling/properties/mongos/properties/replicas
                      - type: info
                        hasIcon: true
                        label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability. 
              - type: block-layout
                label: Shard horizontal Scaling
                showLabels: false
                elements:
                  - type: label-element
                    label: Shard
                  - type: horizontal-layout
                    elements:
                      - type: input-compare
                        label: Replicas
                        subtitle: Define the total number of replicas for the database. Increasing replicas improves fault tolerance and load distribution , while reducing replicas conserves resources
                        init:
                          type: func
                          value: setValueFromDbDetails|/spec/shardTopology/shard/replicas
                        schema: schema/properties/spec/properties/horizontalScaling/properties/shard/properties/replicas
                      - type: info
                        hasIcon: true
                        label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability. 4
                  - type: input
                    label: Shards
                    init:
                      type: func
                      value: setValueFromDbDetails|/spec/shardTopology/shard/shards
                    schema: schema/properties/spec/properties/horizontalScaling/properties/shard/properties/shards
# vertical Scale           
      - type: block-layout
        if:
          type: function
          name: ifRequestTypeEqualsTo|VerticalScaling
        elements:
          - type: block-layout
            label: Standalone Vertical Scaling
            if:
              type: function
              name: ifDbTypeEqualsTo|standalone|verticalScaling
            elements:
              - type: machine-compare
                label: Resources
                subtitle: Compare your current machine configuration with the proposed memory adjustments and make informed decisions for your database setup
                loader: getMachines|standalone
                init:
                  type: func
                  value: setMachine|standalone
                watcher:
                  func: onMachineChange|standalone|/spec/podTemplate/spec/resources
                  paths:
                    - schema/properties/spec/properties/verticalScaling/properties/standalone/properties/resources
                schema: schema/properties/spec/properties/verticalScaling/properties/standalone/properties/resources
              - type: block-layout
                label: Node Selection 
                showLabels: true
                elements:
                  - type: horizontal-layout
                    elements:
                    - type: block-layout
                      showLabels: false
                      hideBorder: true
                      elements:
                        - type: label-element
                          label: Node Selection Policy
                          subtitle: Control where your workloads runs by configuring node selection criteria. Use label selectors to match specific nodes or taints to avoid unsuitable nodes
                        - type: select
                          label: Node Selection Policy
                          schema: schema/properties/spec/properties/verticalScaling/properties/standalone/properties/nodeSelectionPolicy
                          options:
                            - text: LabelSelector
                              value: LabelSelector
                            - text: Taint
                              value: Taint
                    - type: info
                      label: "<b> Label Selector:</b> Specify key-value pairs to target nodes that match your workload's requirements. <br/><b> Taints:</b> Define tolerations for node taints to ensure your workload runs only on compatible nodes"
                      customClass: mt-20
                  - type: label-element
                    label: Topology
                    subtitle: Define node topology preferences, such as zone or region. For example, 'zone=us-central1-a' ensures workloads are deployed in that zone.
                  - type: horizontal-layout
                    elements:
                      - type: input
                        label: Key
                        validation:
                          type: custom
                          name: isVerticalScaleTopologyRequired|standalone
                        schema: temp/topologyKey-standalone
                      - type: input
                        label: Value
                        validation:
                          type: custom
                          name: isVerticalScaleTopologyRequired|standalone
                        schema: temp/topologyValue-standalone
          - type: block-layout
            label: ReplicaSet Vertical Scaling
            if:
              type: function
              name: ifDbTypeEqualsTo|replicaSet|verticalScaling
            elements:
              - type: machine-compare
                label: Resources
                subtitle: Compare your current machine configuration with the proposed memory adjustments and make informed decisions for your database setup
                loader: getMachines|replicaSet
                init:
                  type: func
                  value: setMachine|replicaSet
                watcher:
                  func: onMachineChange|replicaSet|/spec/podTemplate/spec/resources
                  paths:
                    - schema/properties/spec/properties/verticalScaling/properties/replicaSet/properties/resources
                schema: schema/properties/spec/properties/verticalScaling/properties/replicaSet/properties/resources
              - type: block-layout
                label: Node Selection 
                showLabels: true
                elements:
                  - type: horizontal-layout
                    elements:
                    - type: block-layout
                      showLabels: false
                      hideBorder: true
                      elements:
                        - type: label-element
                          label: Node Selection Policy 
                          subtitle: Control where your workloads runs by configuring node selection criteria. Use label selectors to match specific nodes or taints to avoid unsuitable nodes
                        - type: select
                          label: Node Selection Policy
                          schema: schema/properties/spec/properties/verticalScaling/properties/replicaSet/properties/nodeSelectionPolicy
                          options:
                            - text: LabelSelector
                              value: LabelSelector
                            - text: Taint
                              value: Taint
                    - type: info
                      label: "<b> Label Selector:</b> Specify key-value pairs to target nodes that match your workload's requirements. <br/><b> Taints:</b> Define tolerations for node taints to ensure your workload runs only on compatible nodes"
                      customClass: mt-20
                  - type: label-element
                    label: Topology
                    subtitle: Define node topology preferences, such as zone or region. For example, 'zone=us-central1-a' ensures workloads are deployed in that zone.
                  - type: horizontal-layout
                    elements:
                      - type: input
                        label: Key
                        validation:
                          type: custom
                          name: isVerticalScaleTopologyRequired|replicaSet
                        schema: temp/topologyKey-replicaSet
                      - type: input
                        label: Value
                        validation:
                          type: custom
                          name: isVerticalScaleTopologyRequired|replicaSet
                        schema: temp/topologyValue-replicaSet
              - type: label-element
                label: ''
                customClass: mb-20
          - type: block-layout
            if:
              type: function
              name: ifDbTypeEqualsTo|sharded|verticalScaling
            label: Sharded Vertical Scaling
            showLabels: false
            elements:
              - type: block-layout
                label: Config Server Vertical Scaling
                showLabels: true
                elements:
                  - type: machine-compare
                    label: Resources
                    subtitle: Compare your current machine configuration with the proposed memory adjustments and make informed decisions for your database setup
                    loader: getMachines|configServer
                    init:
                      type: func
                      value: setMachine|configServer
                    watcher:
                      func: onMachineChange|configServer|/spec/shardTopology/configServer/podTemplate/spec/resources
                      paths:
                        - schema/properties/spec/properties/verticalScaling/properties/configServer/properties/resources
                    schema: schema/properties/spec/properties/verticalScaling/properties/configServer/properties/resources
                  - type: block-layout
                    label: Node Selection 
                    showLabels: true
                    elements:
                      - type: horizontal-layout
                        elements:
                        - type: block-layout
                          showLabels: false
                          hideBorder: true
                          elements:
                            - type: label-element
                              label: Node Selection Policy
                              subtitle: Control where your workloads runs by configuring node selection criteria. Use label selectors to match specific nodes or taints to avoid unsuitable nodes
                            - type: select
                              label: Node Selection Policy
                              schema: schema/properties/spec/properties/verticalScaling/properties/configServer/properties/nodeSelectionPolicy
                              options:
                                - text: LabelSelector
                                  value: LabelSelector
                                - text: Taint
                                  value: Taint
                        - type: info
                          label: "<b> Label Selector:</b> Specify key-value pairs to target nodes that match your workload's requirements. <br/><b> Taints:</b> Define tolerations for node taints to ensure your workload runs only on compatible nodes"
                          customClass: mt-20
                      - type: label-element
                        label: Topology
                        subtitle: Define node topology preferences, such as zone or region. For example, 'zone=us-central1-a' ensures workloads are deployed in that zone.
                      - type: horizontal-layout
                        elements:
                          - type: input
                            label: Key
                            validation:
                              type: custom
                              name: isVerticalScaleTopologyRequired|configServer
                            schema: temp/topologyKey-configServer
                          - type: input
                            label: Value
                            validation:
                              type: custom
                              name: isVerticalScaleTopologyRequired|configServer
                            schema: temp/topologyValue-configServer
              - type: block-layout
                label: Mongos Vertical Scaling
                showLabels: true
                elements:
                  - type: machine-compare
                    label: Resources
                    subtitle: Compare your current machine configuration with the proposed memory adjustments and make informed decisions for your database setup
                    loader: getMachines|mongos
                    init:
                      type: func
                      value: setMachine|mongos
                    watcher:
                      func: onMachineChange|mongos|/spec/shardTopology/mongos/podTemplate/spec/resources
                      paths:
                        - schema/properties/spec/properties/verticalScaling/properties/mongos/properties/resources
                    schema: schema/properties/spec/properties/verticalScaling/properties/mongos/properties/resources
                  - type: block-layout
                    label: Node Selection 
                    showLabels: true
                    elements:
                      - type: horizontal-layout
                        elements:
                        - type: block-layout
                          showLabels: false
                          hideBorder: true
                          elements:
                            - type: label-element
                              label: Node Selection Policy
                              subtitle: Control where your workloads runs by configuring node selection criteria. Use label selectors to match specific nodes or taints to avoid unsuitable nodes
                            - type: select
                              label: Node Selection Policy
                              schema: schema/properties/spec/properties/verticalScaling/properties/mongos/properties/nodeSelectionPolicy
                              options:
                                - text: LabelSelector
                                  value: LabelSelector
                                - text: Taint
                                  value: Taint
                        - type: info
                          label: "<b> Label Selector:</b> Specify key-value pairs to target nodes that match your workload's requirements. <br/><b> Taints:</b> Define tolerations for node taints to ensure your workload runs only on compatible nodes"
                          customClass: mt-20
                      - type: label-element
                        label: Topology
                        subtitle: Define node topology preferences, such as zone or region. For example, 'zone=us-central1-a' ensures workloads are deployed in that zone.
                      - type: horizontal-layout
                        elements:
                          - type: input
                            label: Key
                            validation:
                              type: custom
                              name: isVerticalScaleTopologyRequired|mongos
                            schema: temp/topologyKey-mongos
                          - type: input
                            label: Value
                            validation:
                              type: custom
                              name: isVerticalScaleTopologyRequired|mongos
                            schema: temp/topologyValue-mongos
              - type: block-layout
                label: Shard Vertical Scaling
                showLabels: true
                elements:
                  - type: machine-compare
                    label: Resources
                    subtitle: Compare your current machine configuration with the proposed memory adjustments and make informed decisions for your database setup
                    loader: getMachines|shard
                    init:
                      type: func
                      value: setMachine|shard
                    watcher:
                      func: onMachineChange|shard|/spec/shardTopology/shard/podTemplate/spec/resources
                      paths:
                        - schema/properties/spec/properties/verticalScaling/properties/shard/properties/resources
                    schema: schema/properties/spec/properties/verticalScaling/properties/shard/properties/resources
                  - type: block-layout
                    label: Node Selection
                    showLabels: true
                    elements:
                      - type: horizontal-layout
                        elements:
                        - type: block-layout
                          showLabels: false
                          hideBorder: true
                          elements:
                            - type: label-element
                              label: Node Selection Policy
                              subtitle: Control where your workloads runs by configuring node selection criteria. Use label selectors to match specific nodes or taints to avoid unsuitable nodes
                            - type: select
                              label: Node Selection Policy
                              schema: schema/properties/spec/properties/verticalScaling/properties/shard/properties/nodeSelectionPolicy
                              options:
                                - text: LabelSelector
                                  value: LabelSelector
                                - text: Taint
                                  value: Taint
                        - type: info
                          label: "<b> Label Selector:</b> Specify key-value pairs to target nodes that match your workload's requirements. <br/><b> Taints:</b> Define tolerations for node taints to ensure your workload runs only on compatible nodes"
                          customClass: mt-20
                      - type: label-element
                        label: Topology
                        subtitle: Define node topology preferences, such as zone or region. For example, 'zone=us-central1-a' ensures workloads are deployed in that zone.
                      - type: horizontal-layout
                        elements:
                          - type: input
                            label: Key
                            validation:
                              type: custom
                              name: isVerticalScaleTopologyRequired|shard
                            schema: temp/topologyKey-shard
                          - type: input
                            label: Value
                            validation:
                              type: custom
                              name: isVerticalScaleTopologyRequired|shard
                            schema: temp/topologyValue-shard
# Volume Expansion
      
      - type: block-layout
        label: Volume Expansion Form
        if:
          type: function
          name: ifRequestTypeEqualsTo|VolumeExpansion
        elements:
          - type: horizontal-layout
            if:
              type: function
              name: ifDbTypeEqualsTo|standalone|volumeExpansion
            elements:
              - type: input-compare
                header: Standalone
                subtitle: How much extra storage does your database need? Specify the size(e.g. 2Gi for 2 gigabytes) so we can allocate it correctly
                label: Standalone
                init:
                  type: func
                  value: setValueFromDbDetails|/spec/storage/resources/requests/storage
                validation:
                  type: custom
                  name: checkVolume|/spec/storage/resources/requests/storage|/spec/volumeExpansion/standalone
                schema: schema/properties/spec/properties/volumeExpansion/properties/standalone
          - type: block-layout
            label: Sharded volume expansion
            if:
              type: function
              name: ifDbTypeEqualsTo|sharded|volumeExpansion
            elements:
              - type: horizontal-layout
                elements:
                  - type: input-compare
                    header: Config Server
                    label: Config Server
                    subtitle: How much extra storage does your database need? Specify the size(e.g., 2Gi for 2 gigabytes) so we can allocate it correctly
                    init:
                      type: func
                      value: setValueFromDbDetails|/spec/shardTopology/configServer/storage/resources/requests/storage
                    validation:
                      type: custom
                      name: checkVolume|/spec/shardTopology/configServer/storage/resources/requests/storage|/spec/volumeExpansion/configServer
                    schema: schema/properties/spec/properties/volumeExpansion/properties/configServer
                  - type: info
                    hasIcon: true
                    label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability.  
              - type: horizontal-layout
                elements:
                  - type: input-compare
                    header: Shard
                    label: Shard
                    subtitle: How much extra storage does your database need? Specify the size(e.g., 2Gi for 2 gigabytes) so we can allocate it correctly
                    init:
                      type: func
                      value: setValueFromDbDetails|/spec/shardTopology/shard/storage/resources/requests/storage
                    validation:
                      type: custom
                      name: checkVolume|/spec/shardTopology/shard/storage/resources/requests/storage|/spec/volumeExpansion/shard
                    schema: schema/properties/spec/properties/volumeExpansion/properties/shard
                  - type: info
                    hasIcon: true
                    label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability. 
              - type: horizontal-layout
                elements:
                  - type: block-layout
                    showLabels: false
                    elements:
                      - type: label-element
                        label: Mode (Required)
                        subtitle: Not sure which mode to pick? Use Online Mode for smooth operations with minimal disruption. Choose offline Mode if you can afford a brief downntime for added reliability during the volume expansion.
                      - type: select
                        label: Mode
                        options:
                          - text: Offline
                            value: Offline
                          - text: Online
                            value: Online
                        validation:
                          type: required
                        schema: schema/properties/spec/properties/volumeExpansion/properties/mode
                  - type: block-layout
                    showLabels: true
                    hideBorder: true
                    elements: []
          - type: horizontal-layout
            if:
              type: function
              name: ifDbTypeEqualsTo|replicaSet|volumeExpansion
            elements:
              - type: input-compare
                header: Replica Set
                subtitle: How much extra storage does your database need? Specify the size(e.g. 2Gi for 2 gigabytes) so we can allocate it correctly
                label: ReplicaSet
                init:
                  type: func
                  value: setValueFromDbDetails|/spec/storage/resources/requests/storage
                validation:
                  type: custom
                  name: checkVolume|/spec/storage/resources/requests/storage|/spec/volumeExpansion/replicaSet
                schema: schema/properties/spec/properties/volumeExpansion/properties/replicaSet
              - type: info
                hasIcon: true
                label: Each replica represents an independent copy of your database. For example, setting this to 3 creates three copies of the database for better availability. 
# Reconfigure
      - type: block-layout
        label: Reconfigure Form
        if:
          name: ifRequestTypeEqualsTo|Reconfigure
          type: function
        elements:
          - type: block-layout
            label: Standalone
            if:
              name: ifDbTypeEqualsTo|standalone|configuration
              type: function
            elements:
              - type: radio
                label: Reconfigure Type
                subtitle: Choose the action you'd like to perform. Select a new configuration secret, apply a custom configuration , or remove an existing setup.
                validation:
                  type: required
                options:
                - text: New Config Secret
                  value: selectNewConfigSecret
                - text: Apply Config
                  value: applyConfig
                - text: Remove testing
                  value: remove
                schema: temp/properties/reconfigurationType
                watcher:
                  func: onReconfigurationTypeChange|standalone
                  paths:
                    - temp/properties/reconfigurationType
              - type: block-layout
                label: Config Secret
                showLabels: true
                if:
                  name: ifReconfigurationTypeEqualsTo|selectNewConfigSecret
                  type: function
                elements:
                  - type:  label-element
                    label: Select a configuration secret from the available list to update your database settings
                    customClass: mb-10
                  - type: select
                    addNewButton:
                      label: Create Secret
                      target: _blank
                      url:
                        function: createSecretUrl
                    schema: schema/properties/spec/properties/configuration/properties/standalone/properties/configSecret/properties/name
                    validation:
                      type: required
                    refresh: true
                    label: Config Secret
                    loader:
                      name: getConfigSecrets
                      watchPaths:
                        - schema/properties/metadata/properties/namespace
                    init:
                      type: func
                      value: setValueFromDbDetails|/spec/configSecret/name
                  - type: label-element
                    label: Selected Config Secret
                    loader: getSelectedConfigSecret|standalone
                    watcher:
                      func: getSelectedConfigSecret|standalone
                      paths:
                        - schema/properties/spec/properties/configuration/properties/standalone/properties/configSecret/properties/name
                  - type: editor
                    label: Value
                    readonly: true
                    hasCopy: false
                    watcher:
                      func: getSelectedConfigSecretValue|standalone
                      paths:
                        - schema/properties/spec/properties/configuration/properties/standalone/properties/configSecret/properties/name
                    validation:
                      type: required
                    schema: temp/properties/configArray/items/properties/value
              - type: array-object-form
                label: ApplyConfig
                buttonClass: is-light is-outlined
                schema: temp/properties/standalone/applyConfig
                validation:
                  type: required
                if:
                  name: ifReconfigurationTypeEqualsTo|applyConfig
                  type: function
                watcher:
                  func: onApplyconfigChange|standalone
                  paths:
                    - temp/properties/standalone/applyConfig
                elements:
                  - type: label-element
                    label: New Apply Config
                    subtitle: Define custom configurations for your database using key-value pairs. These parameters will overwrite existing settings. Enter the parameter you want to configure (e.g., max_connections).
                    customClass: mb-10
                  - type: input
                    label: key
                    validation:
                      type: required
                    schema: key
                  - type: editor
                    label: value
                    hasCopy: false
                    validation:
                      type: required
                    schema: value
              - type: switch
                schema:  schema/properties/spec/properties/configuration/properties/standalone/properties/removeCustomConfig
                label: Remove CustomConfig
                fullwidth: true
                if:
                  name: returnFalse
                  type: function
          - type: block-layout
            label: Replica Set 
            if:
              name: ifDbTypeEqualsTo|replicaSet|configuration
              type: function
            elements:
              - type: radio
                label: Reconfigure Type
                subtitle: Choose the action you'd like to perform. Select a new configuration secret, apply a custom configuration , or remove an existing setup.
                validation:
                  type: required
                options:
                - text: New Config Secret
                  value: selectNewConfigSecret
                - text: Apply Config
                  value: applyConfig
                - text: Remove testing
                  value: remove
                schema: temp/properties/reconfigurationType
                watcher:
                  func: onReconfigurationTypeChange|replicaSet
                  paths:
                    - temp/properties/reconfigurationType
              - type: block-layout
                label: Config Secret 
                showLabels: true
                if:
                  name: ifReconfigurationTypeEqualsTo|selectNewConfigSecret
                  type: function
                elements:
                  - type:  label-element
                    label: Select a configuration secret from the available list to update your database settings
                    customClass: mb-10
                  - type: select
                    addNewButton:
                      label: Create a new Secret
                      target: _blank
                      url:
                        function: createSecretUrl
                    schema: schema/properties/spec/properties/configuration/properties/replicaSet/properties/configSecret/properties/name
                    validation: 
                      type: required
                    refresh: true
                    label: Config Secret
                    loader:
                      name: getConfigSecrets
                      watchPaths:
                        - schema/properties/metadata/properties/namespace
                    init:
                      type: func
                      value: setValueFromDbDetails|/spec/configSecret/name
                  - type: label-element
                    label: Selected Config Secret
                    loader: getSelectedConfigSecret|replicaSet
                    watcher:
                      func: getSelectedConfigSecret|replicaSet
                      paths:
                        - schema/properties/spec/properties/configuration/properties/replicaSet/properties/configSecret/properties/name
                  - type: editor
                    label: Value
                    readonly: true
                    hasCopy: false
                    watcher:
                      func: getSelectedConfigSecretValue|replicaSet
                      paths:
                        - schema/properties/spec/properties/configuration/properties/replicaSet/properties/configSecret/properties/name
                    validation: 
                      type: required
                    schema: temp/properties/configArray/items/properties/value
              - type: array-object-form
                label: ApplyConfig
                schema: temp/properties/replicaSet/applyConfig
                buttonClass: is-light is-outlined
                validation:
                  type: required
                if:
                  name: ifReconfigurationTypeEqualsTo|applyConfig
                  type: function
                watcher:
                  func: onApplyconfigChange|replicaSet
                  paths:
                    - temp/properties/replicaSet/applyConfig
                elements:
                  - type: label-element
                    label: New Apply Config 
                    subtitle: Define custom configurations for your database using key-value pairs. These parameters will overwrite existing settings. Enter the parameter you want to configure (e.g., max_connections).
                    customClass: mb-10
                  - type: input
                    label: key
                    validation:
                      type: required
                    schema: temp/properties/configArray/items/properties/key
                  - type: editor
                    label: value
                    hasCopy: false
                    validation:
                      type: required
                    schema: temp/properties/configArray/items/properties/value
              - type: switch
                schema: schema/properties/spec/properties/configuration/properties/replicaSet/properties/removeCustomConfig
                label: Remove CustomConfig
                fullwidth: true
                if:
                  name: returnFalse
                  type: function
          - type: block-layout
            elements:
            - type: block-layout
              label: Config Server
              showLabels: true
              elements:
                - type: radio
                  label: Reconfigure Type
                  subtitle: Choose the action you'd like to perform. Select a new configuration secret, apply a custom configuration , or remove an existing setup.
                  validation:
                    type: required
                  schema: temp/properties/reconfigurationType-configServer
                  options:
                    - text: New Config Secret
                      value: selectNewConfigSecret
                    - text: Apply Config
                      value: applyConfig
                    - text: Remove testing
                      value: remove
                  watcher:
                    func: onReconfigurationTypeChange|configServer|true
                    paths:
                      - temp/properties/reconfigurationType-configServer
                - type: block-layout
                  label: Config Secret
                  showLabels: true
                  if:
                    name: ifReconfigurationTypeEqualsTo|selectNewConfigSecret|configServer|true
                    type: function
                  elements:
                    - type:  label-element
                      label: Select a configuration secret from the available list to update your database settings
                      customClass: mb-10
                    - type: select
                      addNewButton:
                        label: Create Secret
                        target: _blank
                        url:
                          function: createSecretUrl
                      schema: schema/properties/spec/properties/configuration/properties/configServer/properties/configSecret/properties/name
                      validation:
                        type: required
                      refresh: true
                      label: Config Secret
                      loader:
                        name: getConfigSecrets
                        watchPaths:
                          - schema/properties/metadata/properties/namespace
                      init:
                        type: func
                        value: setValueFromDbDetails|/spec/shardTopology/configServer/configSecret/name
                    - type: label-element
                      label: Selected Config Secret
                      loader: getSelectedConfigSecret|configServer
                      watcher:
                        func: getSelectedConfigSecret|configServer
                        paths:
                          - schema/properties/spec/properties/configuration/properties/configServer/properties/configSecret/properties/name
                    - type: editor
                      label: Value
                      readonly: true
                      hasCopy: false
                      watcher:
                        func: getSelectedConfigSecretValue|configServer
                        paths:
                          - schema/properties/spec/properties/configuration/properties/configServer/properties/configSecret/properties/name
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/value
                - type: array-object-form
                  label: ApplyConfig
                  schema: temp/properties/configServer/applyConfig
                  buttonClass: is-light is-outlined
                  validation:
                    type: required
                  if:
                    name: ifReconfigurationTypeEqualsTo|applyConfig|configServer|true
                    type: function
                  watcher:
                    func: onApplyconfigChange|configServer
                    paths:
                      - temp/properties/configServer/applyConfig
                  elements:
                    - type: label-element
                      label: New Apply Config
                      subtitle: Define custom configurations for your database using key-value pairs. These parameters will overwrite existing settings. Enter the parameter you want to configure (e.g., max_connections).
                      customClass: mb-10
                    - type: input
                      label: key
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/key
                    - type: editor
                      label: value
                      hasCopy: false
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/value

                - type: switch
                  label: Remove CustomConfig
                  fullwidth: true
                  schema: schema/properties/spec/properties/configuration/properties/configServer/properties/removeCustomConfig
                  if:
                    name: returnFalse
                    type: function
            - type: block-layout
              label: Mongos
              showLabels: true
              elements:
                - type: radio
                  label: Reconfigure Type
                  subtitle: Choose the action you'd like to perform. Select a new configuration secret, apply a custom configuration , or remove an existing setup.
                  validation:
                    type: required
                  schema: temp/properties/reconfigurationType-mongos
                  options:
                    - text: New Config Secret
                      value: selectNewConfigSecret
                    - text: Apply Config
                      value: applyConfig
                    - text: Remove testing
                      value: remove
                  watcher:
                    func: onReconfigurationTypeChange|mongos|true
                    paths:
                      - temp/properties/reconfigurationType-mongos
                - type: block-layout
                  label: Config Secret
                  showLabels: true
                  if:
                    name: ifReconfigurationTypeEqualsTo|selectNewConfigSecret|mongos|true
                    type: function
                  elements:
                    - type:  label-element
                      label: Select a configuration secret from the available list to update your database settings
                      customClass: mb-10
                    - type: select
                      addNewButton:
                        label: Create Secret
                        target: _blank
                        url:
                          function: createSecretUrl
                      schema: schema/properties/spec/properties/configuration/properties/mongos/properties/configSecret/properties/name
                      validation:
                        type: required
                      refresh: true
                      label: Config Secret
                      loader:
                        name: getConfigSecrets
                        watchPaths:
                          - schema/properties/metadata/properties/namespace
                      init:
                        type: func
                        value: setValueFromDbDetails|/spec/shardTopology/mongos/configSecret/name
                    - type: label-element
                      label: Selected Config Secret
                      loader: getSelectedConfigSecret|mongos
                      watcher:
                        func: getSelectedConfigSecret|mongos
                        paths:
                          - schema/properties/spec/properties/configuration/properties/mongos/properties/configSecret/properties/name
                    - type: editor
                      label: Value
                      readonly: true
                      hasCopy: false
                      watcher:
                        func: getSelectedConfigSecretValue|mongos
                        paths:
                          - schema/properties/spec/properties/configuration/properties/mongos/properties/configSecret/properties/name
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/value
                - type: array-object-form
                  label: ApplyConfig
                  schema: temp/properties/mongos/applyConfig
                  buttonClass: is-light is-outlined
                  validation:
                    type: required
                  if:
                    name: ifReconfigurationTypeEqualsTo|applyConfig|mongos|true
                    type: function
                  watcher:
                    func: onApplyconfigChange|mongos
                    paths:
                      - temp/properties/mongos/applyConfig
                  elements:
                    - type: label-element
                      label: New Apply Config
                      subtitle: Define custom configurations for your database using key-value pairs. These parameters will overwrite existing settings. Enter the parameter you want to configure (e.g., max_connections).
                      customClass: mb-10
                    - type: input
                      label: key
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/key
                    - type: editor
                      label: value
                      hasCopy: false
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/value
                - type: switch
                  label: Remove CustomConfig
                  fullwidth: true
                  schema: schema/properties/spec/properties/configuration/properties/mongos/properties/removeCustomConfig
                  if:
                    name: returnFalse
                    type: function
            - type: block-layout
              label: Shard
              showLabels: true
              elements:
                - type: radio
                  label: Reconfigure Type
                  subtitle: Choose the action you'd like to perform. Select a new configuration secret, apply a custom configuration , or remove an existing setup.
                  validation:
                    type: required
                  schema: temp/properties/reconfigurationType-shard
                  options:
                    - text: New Config Secret
                      value: selectNewConfigSecret
                    - text: Apply Config
                      value: applyConfig
                    - text: Remove testing
                      value: remove
                  watcher:
                    func: onReconfigurationTypeChange|shard|true
                    paths:
                      - temp/properties/reconfigurationType-shard

                - type: block-layout
                  label: Config Secret
                  showLabels: true
                  if:
                    name: ifReconfigurationTypeEqualsTo|selectNewConfigSecret|shard|true
                    type: function
                  elements:
                    - type:  label-element
                      label: Select a configuration secret from the available list to update your database settings
                      customClass: mb-10
                    - type: select
                      addNewButton:
                        label: Create Secret
                        target: _blank
                        url:
                          function: createSecretUrl
                      schema: schema/properties/spec/properties/configuration/properties/shard/properties/configSecret/properties/name
                      validation:
                        type: required
                      refresh: true
                      label: Config Secret
                      loader:
                        name: getConfigSecrets
                        watchPaths:
                          - schema/properties/metadata/properties/namespace
                      init:
                        type: func
                        value: setValueFromDbDetails|/spec/shardTopology/shard/configSecret/name
                    - type: label-element
                      label: Selected Config Secret
                      loader: getSelectedConfigSecret|shard
                      watcher:
                        func: getSelectedConfigSecret|shard
                        paths:
                          - schema/properties/spec/properties/configuration/properties/shard/properties/configSecret/properties/name
                    - type: editor
                      label: Value
                      readonly: true
                      hasCopy: false
                      watcher:
                        func: getSelectedConfigSecretValue|shard
                        paths:
                          - schema/properties/spec/properties/configuration/properties/shard/properties/configSecret/properties/name
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/value
                - type: array-object-form
                  label: ApplyConfig
                  schema: temp/properties/shard/applyConfig
                  buttonClass: is-light is-outlined
                  validation:
                    type: required
                  if:
                    name: ifReconfigurationTypeEqualsTo|applyConfig|shard|true
                    type: function
                  watcher:
                    func: onApplyconfigChange|shard
                    paths:
                      - temp/properties/shard/applyConfig
                  elements:
                    - type: label-element
                      label: New Apply Config
                      subtitle: Define custom configurations for your database using key-value pairs. These parameters will overwrite existing settings. Enter the parameter you want to configure (e.g., max_connections).
                      customClass: mb-10
                    - type: input
                      label: key
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/key
                    - type: editor
                      label: value
                      hasCopy: false
                      validation:
                        type: required
                      schema: temp/properties/configArray/items/properties/value
                - type: switch
                  label: Remove CustomConfig
                  fullwidth: true
                  schema: schema/properties/spec/properties/configuration/properties/shard/properties/removeCustomConfig
                  if:
                    name: returnFalse
                    type: function
            label: Sharded Reconfigure form
            if:
              name: ifDbTypeEqualsTo|sharded|configuration
              type: function
# Reconfigure TLS
      - type: block-layout
        label: TLS
        if:
          name: ifRequestTypeEqualsTo|ReconfigureTLS
          type: function
        elements:
          - type: radio
            label: TLS Operation
            schema: temp/properties/tlsOperation
            if:
              name: hasTlsField
              type: function
            options:
              - text: Update
                value: update
              - text: Rotate
                value: rotate
              - text: Remove
                value: remove
            init:
              type: func
              value: initTlsOperation
            watcher:
              func: onTlsOperationChange
              paths:
                - temp/properties/tlsOperation
          - type: switch
            label: remove
            fullwidth: true
            if:
              name: returnFalse
              type: function
            schema: schema/properties/spec/properties/tls/properties/remove
          - type: switch
            label: rotateCertificates
            fullwidth: true
            schema: schema/properties/spec/properties/tls/properties/rotateCertificates
            if:
              name: returnFalse
              type: function
          - type: block-layout
            label: Issuer Reference
            showLabels: true
            if:
              name: showIssuerRefAndCertificates
              type: function
            elements:
              - type: input
                label: API Group
                init:
                  type: func
                  value: initIssuerRefApiGroup
                watcher:
                  func: initIssuerRefApiGroup
                  paths:
                    - schema/properties/spec/properties/tls/properties/issuerRef/properties/kind
                disable: true
                schema: schema/properties/spec/properties/tls/properties/issuerRef/properties/apiGroup
              - type: select
                label: Kind
                options:
                  - text: Issuer
                    value: Issuer
                  - text: ClusterIssuer
                    value: ClusterIssuer
                init:
                  type: func
                  value: setValueFromDbDetails|/spec/tls/issuerRef/kind
                validation:
                  type: custom
                  name: isIssuerRefRequired
                schema: schema/properties/spec/properties/tls/properties/issuerRef/properties/kind
              - type: select
                label: Name
                loader:
                  name: getIssuerRefsName
                  watchPaths:
                    - schema/properties/spec/properties/tls/properties/issuerRef/properties/kind
                    - schema/properties/metadata/properties/namespace
                init:
                  type: func
                  value: setValueFromDbDetails|/spec/tls/issuerRef/name
                validation:
                  type: custom
                  name: isIssuerRefRequired
                schema: schema/properties/spec/properties/tls/properties/issuerRef/properties/name
          - type: block-layout
            label: Certificates
            showLabels: true
            if:
              name: showIssuerRefAndCertificates
              type: function
            loader: setValueFromDbDetails|/spec/tls/certificates|/spec/tls/certificates
            elements:
              - type: select
                label: Alias
                loader: fetchAliasOptions
                disable: disableAlias
                schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/alias
              - type: input
                label: Secret Name
                schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/secretName
              - type: input
                label: Duration
                schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/duration
              - type: input
                label: Renew Before
                schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/renewBefore
              - type: block-layout
                label: Subject
                showLabels: true
                elements:
                  - type: array-item-form
                    label: Organizations
                    buttonClass: is-light is-outlined
                    schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/subject/properties/organizations
                    element:
                      type: input
                      label: Organization
                  - type: array-item-form
                    label: Countries
                    buttonClass: is-light is-outlined
                    schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/subject/properties/countries
                    element:
                      type: input
                      label: Country
                  - type: array-item-form
                    label: Organizational Units
                    buttonClass: is-light is-outlined
                    schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/subject/properties/organizationalUnits
                    element:
                      type: input
                      label: Organizational Unit
                  - type: array-item-form
                    label: Provinces
                    buttonClass: is-light is-outlined
                    schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/subject/properties/provinces
                    element:
                      type: input
                      label: Province
              - type: array-item-form
                label: DNS Names
                buttonClass: is-light  is-outlined
                schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/dnsNames
                element:
                  type: input
                  label: DNS Name
              - type: array-item-form
                label: IP Addresses
                buttonClass: is-light is-outlined
                schema: schema/properties/spec/properties/tls/properties/certificates/items/properties/ipAddresses
                element:
                  type: input
                  label: IP Address
# common
      - type: block-layout
        label: OpsRequest Options
        showLabels: true
        elements:
          - type: time-picker
            label: Timeout
            schema: 'schema/properties/spec/properties/timeout'
            subtitle: Specify the maximum time allowed for the scaling operation to complete. Use formats like 30sec, 1min(1 minute) or 2h(2 hours).
          - type: radio
            label: Apply
            schema: 'schema/properties/spec/properties/apply'
            init:
              type: func
              value: setApplyToIfReady
            options:
              - text: IfReady (OpsRequest will be applied if database is ready)
                value: IfReady
              - text: Always (OpsRequest will always be applied)
                value: Always
